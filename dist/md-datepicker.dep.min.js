var id=0,locale={en:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],weekday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],_button:{_clean:"delete",_cancel:"cancel"}},de:{month:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekday:["So","Mo","Di","Mi","Do","Fr","Sa"],_button:{_clean:"Löschen",_cancel:"Abrrechen"}}};(function(e,t,a,s){e.fn.md_datepicker=function(n){"use strict";if(a.createElement("div").style.flex==s){return e(this).each(function(e,t){try{t.type="date"}catch(e){t.type="text"}})}function r(e){return a.createElementNS(X,e)}function i(e,t,a,s,n){return'<div class="lolliclock-tick" style="left:'+(e+Math.sin(t)*(F*n)-a).toFixed(2)+"px;top:"+(e-Math.cos(t)*(F*n)-a).toFixed(2)+'px">'+s+"</div>"}id++;var d=false;this.each(function(){if(this.initilized)d=true});if(d)return;var l={language:null,theme:"light",timepicker:false,startday:1,autoclose:false,mindate:null,maxdate:null,color:null,_24h:false,format:null,animated:true,submit:"string",custom_class:""},o=toLocaleStringSupports(),c="ontouchstart"in t,m="mousedown"+(c?" touchstart":""),u="mousemove.lolliclock"+(c?" touchmove.lolliclock":""),h="mouseup.lolliclock"+(c?" touchend.lolliclock":""),p="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",v=new Date,f=e.extend({},l,n),g=[0,1,2,3,4,5,6],y=g.splice(-f.startday),g=y.concat(g);f.language=f.language?f.language:navigator.language||navigator.userLanguage||"en";v.setSeconds(0);if(f.format){var b=f.format.match(/\W/),D=f.format.split(" ")[0].split(b).reverse();e.each(f.format.split(" ")[1].split(":"),function(e,t){D.push(t)})}if(o){for(var k=0,w,P=[];k<7;k++){w=new Date(2015,1,k);P[w.getDateParts().weekday]=w.toLocaleString(f.language,{weekday:"short"}).replace(".","")}for(var k=0,w,x=[];k<12;k++){w=new Date(2015,k,1);x[k]=w.toLocaleString(f.language,{month:"long"})}}else{var P=locale[f.language.split("-")[0]].weekday.slice(0),x=locale[f.language.split("-")[0]].month.slice(0)}y=P.splice(0,f.startday);var _=P.concat(y),C="",M="",A="";e.each(_,function(e,t){M+="<span>"+t+"</span>"});e.each(x,function(e,t){A+='<span data-month="'+e+'">'+x[e]+"</span>"});for(var k=1,w,S="",E=100,N=v.getDateParts().year;k<E+2;k++){S+="<span>"+(N-(k-(E+2)/2))+"</span>"}var T=e(this);T.each(function(){var t=this.cloneNode(true);t.type="hidden";t.className="";t.output=this;this.readOnly=true;t.id=this.id+"-timestamp";if(f.submit=="timestamp"){this.name=""}else{t.name=""}this.timestamp=t;this.parentNode.appendChild(t);this.onchange=function(e){if(this.value!=""){this.timestamp.value=moment(this.value,f.format).unix();this.date=new Date(moment(this.value,f.format).unix())}else{this.timestamp.value=0;this.timestamp.date=s}};this.timestamp.onchange=function(a){var n=Number(this.value*1e3),r=t.output.onchange;t.output.onchange=null;if(this.value==""){t.output.value="";t.output.date=s}else{t.output.value=moment(n).format(f.format);t.output.date=new Date(n)}e(t.output).change();t.output.onchange=r}});for(var k=1;k<=31;k++){C+="<span>"+k+"</span>"}if(f.timepicker){for(var k=a.styleSheets.length-1;k>=0;k--){if(a.styleSheets[k].href&&a.styleSheets[k].href.indexOf("md-datepicker")>0){var I=a.styleSheets[k].cssRules;for(var k=I.length-1;k>=0;k--){if(I[k].selectorText==".md-clock"){var L=parseInt(I[k].style.height)}}}}var O=L/2,F=O-32,V=20,z=O*2,H=350;var J=f._24h?25:13;for(var k=1,j="",Y;k<J;k++){Y=k/6*Math.PI;if(f._24h&&k<13){j+=i(O,Y,V,k,.6)}else{j+=i(O,Y,V,k,1)}}for(var k=0,W="",Y;k<60;k+=5){Y=k/30*Math.PI;W+=i(O,Y,V,k.pad(2),1)}var $=""+'<div class="md-datepicker-timeview">'+'<div class="md-datepick-header">'+'<div class="md-datepicker-headline">'+'<span class="md-hour"></span>'+":"+'<span class="md-minute"></span>'+'<div class="md-ampm-toggle">'+'<span class="md-am">AM</span>'+'<span class="md-pm">PM</span>'+"</div>"+"</div>"+'<i class="md-toggle-state no-hover">&#xE878</i>'+"</div>"+'<div class="md-clock">'+'<div class="md-hours">'+j+"</div>"+'<div class="md-minutes">'+W+"</div>"+"</div>"+"</div>",X="http://www.w3.org/2000/svg";var B=r("svg");B.setAttribute("class","lolliclock-svg");B.setAttribute("width",z);B.setAttribute("height",z);var R=r("g");R.setAttribute("transform","translate("+O+","+O+")");var q=r("circle");q.setAttribute("class","lolliclock-bearing");q.setAttribute("cx",0);q.setAttribute("cy",0);q.setAttribute("r",5);var K=r("line");K.setAttribute("x1",0);K.setAttribute("y1",0);var Q=r("circle");Q.setAttribute("class","lolliclock-canvas-bg");Q.setAttribute("r",20);var G=r("circle");G.setAttribute("class","lolliclock-canvas-fg");G.setAttribute("r",3.5);R.appendChild(K);R.appendChild(Q);R.appendChild(G);R.appendChild(q);B.appendChild(R);var U=function(t){var s=ue.offset(),n=/^touch/.test(t.type),r=s.left+O,i=s.top+O,d=(n?t.originalEvent.touches[0]:t).pageX-r,l=(n?t.originalEvent.touches[0]:t).pageY-i,o=Math.sqrt(d*d+l*l),c=false;if(o<F-V||o>F+V){return}t.preventDefault();e(a.body).addClass("lolliclock-moving");ue.append(self.canvas);ee(d,l);e(a).off(u).on(u,function(e){e.preventDefault();var t=/^touch/.test(e.type),a=(t?e.originalEvent.touches[0]:e).pageX-r,s=(t?e.originalEvent.touches[0]:e).pageY-i;if(!c&&a===d&&s===l){return}c=true;ee(a,s)});e(a).off(h).on(h,function(t){t.preventDefault();var s=/^touch/.test(t.type),n=(s?t.originalEvent.changedTouches[0]:t).pageX-r,o=(s?t.originalEvent.changedTouches[0]:t).pageY-i;if(n===d&&o===l){ee(n,o)}if(me.currentView==="hours"){ne(true)}else if(f.autoclose){}e(a.body).removeClass("lolliclock-moving");e(a).off(u);e(a).off(h)})}}var Z='<div class="md-datepicker md-'+f.theme.split(" ").join(" md-")+(f.animated=="all"||f.animated=="inout"||f.animated?" md-datepicker-animated":"")+(f.custom_class!=""?" "+f.custom_class:"")+'" id="md-datepicker-'+id.pad(3)+'">'+'<div class="md-datepicker-views">'+'<div class="md-datepicker-dateview">'+'<div class="md-datepick-header">'+"<div>"+'<span class="year"></span>'+"</div>"+'<div class="md-datepicker-headline">'+'<span class="weekday"></span><span class="day"></span> <span class="month"></span>'+"</div>"+(f.timepicker?'<i class="md-toggle-state no-hover">&#xE192;</i>':"")+"</div>"+'<div class="md-datepick-month">'+'<i class="md-previous md-touchtarget no-hover">&#xE408;</i><i class="md-next md-touchtarget no-hover">&#xE409;</i>'+"</div>"+'<div class="md-months">'+'<div class="md-previous-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+M+"</div>"+'<div class="md-week">'+C+"</div>"+"</div>"+'<div class="md-current-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+M+"</div>"+'<div class="md-week">'+C+"</div>"+"</div>"+'<div class="md-next-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+M+"</div>"+'<div class="md-week">'+C+"</div>"+"</div>"+"</div>"+'<div class="month-select md-select-wrap">'+A+"</div>"+'<div class="year-select md-select-wrap">'+S+"</div>"+"</div>"+(f.timepicker?$:"")+"</div>"+'<div class="md-buttons">'+'<div class="md-button-flat button-delete">'+locale[f.language.split("-")[0]]._button._clean+"</div>"+'<div class="md-button-flat button-cancel">'+locale[f.language.split("-")[0]]._button._cancel+"</div>"+'<div class="md-button-flat button-ok">OK</div>'+"</div>"+"</div>";var ee=function(t,a){var s=Math.atan2(-t,a)+Math.PI;var n=me.currentView==="hours";var r=Math.PI/(n?6:30);var i;i=Math.round(s/r);s=i*r;if(n){if(i===0){i=12}me.fg.style.visibility="hidden";me.el.hour.text(me.hasClass("pm")?i+12==24?12:(i+12).pad(2):i==12?"00":i.pad(2));me.date.setHours(me.el.hour.text())}else{var d=i%5===0;if(d){me.fg.style.visibility="hidden"}else{me.fg.style.visibility="visible"}if(i===60){i=0}me.el.minute.text(i.pad(2));me.date.setMinutes(me.el.minute.text())}var l=me.currentView=="hours"?me.ticks.hours:me.ticks.minutes;l.each(function(t,a){e(a).toggleClass("active",e(a).text()==i)});me.g.insertBefore(me.hand,me.bearing);me.g.insertBefore(me.bg,me.fg);me.bg.setAttribute("class","lolliclock-canvas-bg");var o=Math.sin(s)*F,c=-Math.cos(s)*F;me.hand.setAttribute("x2",Math.sin(s)*(F-V));me.hand.setAttribute("y2",-Math.cos(s)*(F-V));me.bg.setAttribute("cx",o);me.bg.setAttribute("cy",c);me.fg.setAttribute("cx",o);me.fg.setAttribute("cy",c)};var te=function(a){var s=e(a).offset(),n=me.width(),r=me.height();s.top=s.top+r+8>=t.innerHeight?t.innerHeight-r-8:s.top;s.left=s.left+n+8>=t.innerWidth?t.innerWidth-n-8:s.left;return s};this.show=function(a){me.set=me.start==a?"start":"end";var n=a.value!=""?f.format?moment(a.value,f.format):moment(a.value):moment(me.set=="start"?me.end.date:me.start.date),r=te(a);me.date=new Date(n);me.date=isNaN(me.date.getTime())?new Date:me.date;me.range=le();me.el.prev_next_btns.removeClass("disabled");oe("current");oe("previous");oe("next");se();if(f.animated){me.on(p,function(){me.addClass("animate");me.off(p)});if(me.hasClass("clockpicker")){me.removeClass("clockpicker");me.on(p,".md-datepicker-views",function(t){t.preventDefault();e(me).css({top:r.top,left:r.left}).off(p)})}else{e(me).css({top:r.top,left:r.left}).addClass("md-datepicker-visible")}}else{e(me).css({top:r.top,left:r.left}).addClass("md-datepicker-visible")}me.el.buttons.off();me.el.buttons.on("click",".button-ok",function(t){t.preventDefault();if(e(a).is("[type=date]")){e(a).val(me.date.getDateParts().year+"-"+(me.date.getDateParts().month+1).pad(2)+"-"+me.date.getDateParts().day.pad(2)).change()}else if(f.format){e(a).val(moment(me.date).format(f.format)).change()}else if(f.timepicker){e(a).val(me.date.toLocaleString()).change()}else{e(a).val(me.date.toLocaleDateString()).change()}me[me.set].date=me.date;a.date=me.date;ae(a)});me.el.buttons.on("click",".button-delete",function(t){t.preventDefault();a.date=s;e(a).val("").change();ae(a)});me.el.buttons.children(".button-delete").toggleClass("disabled",a.value=="");me.el.buttons.on("click",".button-cancel",function(e){e.preventDefault();ae(a)});var i;e(t).on("resize",function(e){clearTimeout(i);r=te(a);me.css({top:r.top,left:r.left}).removeClass("animate");i=setTimeout(function(){me.addClass("animate")},100)})};var ae=function(a){e(a).removeClass("focused");me.removeClass("clockpicker md-datepicker-visible animate");me.el.buttons.off();e(t).off("resize")};var se=function(){if(le()){var t=me.set=="start"?"end":"start";var a=e(".md-select-wrap>span:matches("+me[t].date.getDateParts().year+")");if(me.start.date&&me.start.date.getDateParts().year<=me.date.getDateParts().year&&t=="start"||me.end.date&&me.end.date.getDateParts().year>=me.date.getDateParts().year&&t=="end"){e(me.el.prev_next_btns[me.set=="start"|0]).toggleClass("disabled",me.date.getDateParts().year==me[t].date.getDateParts().year&&me[t].date.getDateParts().month==me.date.getDateParts().month);if(me.date.getDateParts().year==me[t].date.getDateParts().year){a.push(e(".md-select-wrap>span[data-month="+me[t].date.getDateParts().month+"]")[0])}me.find(".md-select-wrap>span").removeClass("disabled");if(me.set=="end"){e(a[1]).prevAll().addClass("disabled");e(a[0]).nextAll().addClass("disabled")}else{e(a[0]).prevAll().addClass("disabled");e(a[1]).nextAll().addClass("disabled")}}}else{me.find(".md-select-wrap>span").removeClass("disabled")}me.el.months.text(me.date.loc(f.language,{month:"long"}));me.el.years.text(me.date.getDateParts().year);me.el.days.text(me.date.getDateParts().day);me.el.weekday.text(me.date.loc(f.language,{weekday:"short"}).replace(".",""));if(f.timepicker){me.removeClass("minute");me.currentView="hours";me.toggleClass("pm",me.date.getDateParts().hours>=12);me.el.hour.text(me.date.getDateParts().hours.pad(2));me.el.minute.text(me.date.getDateParts().minutes.pad(2));var s=me.date.getDateParts().hours*(Math.PI/6),n=Math.sin(s)*F,r=-Math.cos(s)*F;ee(n,r)}};var ne=function(t){me.toggleClass("minute",!e(t.target).is(".md-hour"));me.currentView=!e(t.target).is(".md-hour")?"minutes":"hours";var a=(!e(t.target).is(".md-hour")?me.el.minute.text():me.el.hour.text())*(Math.PI/(me.currentView==="hours"?6:30)),s=Math.sin(a)*F,n=-Math.cos(a)*F;ee(s,n)};var re=function(t){var a=t=="year"?e(".md-select-wrap>span:matches("+me.date.getDateParts().year+")"):e(".md-select-wrap>span[data-month="+me.date.getDateParts().month+"]");if(!a.length){var s=me.date.getDateParts().year-Number(me.el.select_year.children(":first-child").text());for(var n=1,r=Number(me.el.select_year.children(":first-child").text());n<=s;n++){me.el.select_year.prepend("<span>"+(r+n)+"</span>")}a=e(".md-select-wrap>span:matches("+me.date.getDateParts().year+")")}var i=a.position().top;me.el["select_"+t].children("span").removeClass("md-currentdate");if(t=="year")e(".md-select-wrap>span:matches("+me.date.getDateParts().year+")").addClass("md-currentdate");else e(".md-select-wrap>span[data-month="+me.date.getDateParts().month+"]").addClass("md-currentdate");me.el["select_"+t].addClass("inview animate");me.el["select_"+t].stop().animate({scrollTop:i+me.el["select_"+t][0].scrollTop-(me.el["select_"+t][0].clientHeight-48)/2},parseInt(Math.abs(i.remap(0,2e3,500,3e3))),"easeInOutExpo");me.el["select_"+t].on(p,function(){me.el["select_"+t].removeClass("animate")});me.el["select_"+t].on("mousewheel",function(e){me.el["select_"+t].stop()})};var ie=function(e){var t=me.range?e=="next"?me.set=="start"&&me.date.getDateParts().month<me.end.date.getDateParts().month||me.set=="start"&&me.date.getDateParts().year!=me.end.date.getDateParts().year||me.set=="end":me.set=="end"&&me.date.getDateParts().month>me.start.date.getDateParts().month||me.set=="end"&&me.date.getDateParts().year!=me.start.date.getDateParts().year||me.set=="start":true;var a=me.set=="start"?"end":"start";if(t){me.el.prev_next_btns.off("click");me.el.month_wrap.addClass("animate "+e);if(e=="next"){me.date.setMonth(me.date.getDateParts().month+1)}else{me.date.setMonth(me.date.getDateParts().month-1)}if(me.range&&me.set=="start"&&me.end.date<=me.date||me.range&&me.set=="end"&&me.start.date>=me.date){me.date=new Date(me[a].date);de()}se();me.el.month_wrap.on(p,function(){me.el.current.html(me.el[e].html());me.el.month_wrap.removeClass("animate "+e);oe("next");oe("previous");me.el.month_wrap.off(p);me.el.prev_next_btns.on("click",ce)})}};var de=function(){var e=["next","previous"];for(var t=e.length-1;t>=0;t--){me.el[e[t]].find(".md-selecteddate").removeClass("md-selecteddate");me.el[e[t]].find("span:matches("+me.date.getDateParts().day+")").addClass("md-selecteddate")}};function le(){if(me.start&&me.end){console.log(me);return me.date!=s&&me[me.set=="start"?"end":"start"].date!=s}else return false}var oe=function(e){var t=me.date.getDateParts().month,a=new Date(me.date),s,n="",r;if(e=="previous"){a.setMonth(t-1)}else if(e=="next"){a.setMonth(t+1)}s=g[startDay(a)];var i=daysInMonth(a);for(var d=f.startday;d<s+f.startday;d++){n+="<span></span>"}var l=v.getDateParts().month==a.getDateParts().month&&v.getDateParts().year==a.getDateParts().year,o=me.set=="start"?"end":"start";if(me.range)var c=a.getDateParts().month==me[o].date.getDateParts().month&&a.getDateParts().year==me[o].date.getDateParts().year;for(var d=1;d<=i;d++){r=[];if(me.date.getDateParts().day==d)r.push("md-selecteddate");if(v.getDateParts().day==d&&l)r.push("md-currentdate");if(me.range&&me.set=="start"&&d>me.end.date.getDateParts().day&&c||me.range&&me.set=="end"&&d<me.start.date.getDateParts().day&&c)r.push("disabled");n+="<span"+(r.length>=1?' class="'+r.join(" ")+'"':"")+" >"+d+"</span>"}me.el[e].find(".md-month-display").text(a.loc(f.language,{month:"long"}));me.el[e].find(".md-year-display").text(a.getDateParts().year);me.el[e].find(".md-week").html(n)};function ce(){ie(this.className.split(" ")[0].split("-")[1])}var me=e(Z).appendTo("body");me.el={};if(f.timepicker){var ue=me.find(".md-clock");ue.append(B);me.hand=K;me.bg=Q;me.fg=G;me.bearing=q;me.g=R;me.canvas=ue;me.ticks={};me.ticks.minutes=me.canvas.find(".md-minutes>div");me.ticks.hours=me.canvas.find(".md-hours>div");me.el.hour=me.find(".md-hour");me.el.minute=me.find(".md-minute");me.el.ampm=me.find(".md-ampm-toggle");me.currentView="hours";ue.on(m,U)}me.el.years=me.find(".year");me.el.months=me.find(".month");me.el.days=me.find(".day");me.el.buttons=me.find(".md-buttons");me.el.weekday=me.find(".weekday");me.el.month_wrap=me.find(".md-months");me.el.current=me.find(".md-current-month");me.el.next=me.find(".md-next-month");me.el.prev_next_btns=me.find(".md-next").add(me.find(".md-previous"));me.el.select_month=me.find(".month-select");me.el.select_year=me.find(".year-select");me.el.previous=me.find(".md-previous-month");me.el.prev_next_btns.on("click",ce);me.on("click",".month-select>span, .year-select>span",function(t){if(e(this).data("month")===s){me.date.setYear(e(this).text());me.el["select_year"].off()}else{me.date.setMonth(e(this).data("month"));me.el["select_month"].off()}if(me.range){if(me.set=="start"&&me.end.date<=me.date||me.set=="end"&&me.start.date>=me.date){var a=me.set=="start"?"end":"start";me.date=new Date(me[a].date)}}se();oe("current");e(this).parents(".md-select-wrap").addClass("animate").removeClass("inview").off(p);oe("previous");oe("next")});me.el.months.on("click",function(e){re("month")});me.el.years.on("click",function(e){re("year")});me.on("click",".md-week span",function(t){e(".md-selecteddate").removeClass("md-selecteddate");me.el.month_wrap.find("span:matches("+e(this).text()+")").addClass("md-selecteddate");me.date.setDate(e(this).text());se()});me.on("click",".md-toggle-state",function(e){me.toggleClass("clockpicker",!me.hasClass("clockpicker"))});me.on("click",".md-minute, .md-hour",function(e){ne(e)});me.on("click",".md-pm, .md-am",function(t){me.toggleClass("pm",!e(t.target).is(".md-am"));var a=parseInt(me.el.hour.text());a=me.hasClass("pm")?a+12==24?12:a+12:a==0?0:a-12;me.el.hour.text(a.pad(2));me.date.setHours(a.pad(2))});var he=this,pe=[];return this.each(function(){this.initilized=true;e(this).on("focus",function(t){t.preventDefault();e(pe).removeClass("focused");e(t.target).addClass("focused");he.show(t.target)});pe.push(this);if(e(this).is("[data-md-start]"))me.start=this;if(e(this).is("[data-md-end]"))me.end=this}).promise().done(function(){me.state="ready";if(pe.length>2&&me.start){throw new Error("Only one start and one end Date is allowed")}me.container=pe})}})(jQuery,window,document);function daysInMonth(e){return new Date(e.getDateParts().year,e.getDateParts().month+1,0).getDateParts().day}function startDay(e){return new Date(e.getDateParts().year,e.getDateParts().month,1).getDateParts().weekday}Number.prototype.remap=function(e,t,a,s){return a+(this-e)*(s-a)/(t-e)};Date.prototype.getDateParts=function(){return{year:this.getFullYear(),month:this.getMonth(),hours:this.getHours(),minutes:this.getMinutes(),day:this.getDate(),weekday:this.getDay()}};Date.prototype.loc=function(e,t){if(toLocaleStringSupports()){return this.toLocaleString(e,t)}else{return locale[e.split("-")[0]][Object.keys(t)[0]][this.getDateParts()[Object.keys(t)]]}};Number.prototype.pad=function(e){var t=String(this);while(t.length<(e||2)){t="0"+t}return t};String.prototype.pad=function(e){var t=String(this);while(t.length<(e||2)){t="0"+t}return t};$.expr[":"].matches=$.expr.createPseudo(function(e){return function(t){return $(t).text().match("^"+e+"$")}});function toLocaleStringSupports(){try{(new Date).toLocaleString("i")}catch(e){return e.name==="RangeError"}return false}
