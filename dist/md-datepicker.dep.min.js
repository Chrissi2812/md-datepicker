var id=0,locale={en:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],weekday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},de:{month:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekday:["So","Mo","Di","Mi","Do","Fr","Sa"]}};(function(e,t,a,s){e.fn.md_datepicker=function(n){"use strict";function i(e){return a.createElementNS(W,e)}function d(e,t,a,s,n){return'<div class="lolliclock-tick" style="left:'+(e+Math.sin(t)*(O*n)-a).toFixed(2)+"px;top:"+(e-Math.cos(t)*(O*n)-a).toFixed(2)+'px">'+s+"</div>"}id++;var r=false;this.each(function(){if(this.initilized)r=true});if(r)return;var l={language:null,theme:"light",timepicker:false,startday:1,autoclose:false,mindate:null,maxdate:null,color:null,_24h:false,format:null,animated:true,submit:"string",custom_class:""},o=function(){Date.prototype.toLocaleString!=s}(),c="ontouchstart"in t,u="mousedown"+(c?" touchstart":""),m="mousemove.lolliclock"+(c?" touchmove.lolliclock":""),p="mouseup.lolliclock"+(c?" touchend.lolliclock":""),h=new Date,v=e.extend({},l,n),f=[0,1,2,3,4,5,6],g=f.splice(-v.startday),f=g.concat(f);v.language=v.language?v.language:navigator.language||navigator.userLanguage||"en";h.setSeconds(0);if(v.format){var b=v.format.match(/\W/),k=v.format.split(" ")[0].split(b).reverse();e.each(v.format.split(" ")[1].split(":"),function(e,t){k.push(t)})}if(o){for(var y=0,w,x=[];y<7;y++){w=new Date(2015,1,y);x[w.g()]=w.toLocaleString(v.language,{weekday:"short"}).replace(".","")}for(var y=0,w,C=[];y<12;y++){w=new Date(2015,y,1);C[y]=w.toLocaleString(v.language,{month:"long"})}}else{var x=locale[v.language].weekday,C=locale[v.language].month}g=x.splice(0,v.startday);var M=x.concat(g),_="",D="",T="";e.each(M,function(e,t){D+="<span>"+t+"</span>"});e.each(C,function(e,t){T+='<span data-month="'+e+'">'+C[e]+"</span>"});for(var y=0,w,E="",A=h.g(1);y<100;y++){E+="<span>"+(A-y)+"</span>"}var S=e(this);S.each(function(){var t=this.cloneNode(true);t.type="hidden";t.className="";t.output=this;this.readOnly=true;t.id=this.id+"-timestamp";if(v.submit=="timestamp"){this.name=""}else{t.name=""}this.timestamp=t;this.parentNode.appendChild(t);this.onchange=function(e){if(this.value!=""){this.timestamp.value=moment(this.value,v.format).unix();this.date=new Date(moment(this.value,v.format).unix())}else{this.timestamp.value=0;this.timestamp.date=s}};this.timestamp.onchange=function(a){var n=Number(this.value*1e3),i=t.output.onchange;t.output.onchange=null;if(this.value==""){t.output.value="";t.output.date=s}else{t.output.value=moment(n).format(v.format);t.output.date=new Date(n)}e(t.output).change();t.output.onchange=i}});for(var y=1;y<=31;y++){_+="<span>"+y+"</span>"}if(v.timepicker){for(var y=a.styleSheets.length-1;y>=0;y--){if(a.styleSheets[y].href&&a.styleSheets[y].href.indexOf("md-datepicker")>0){var N=a.styleSheets[y].cssRules;for(var y=N.length-1;y>=0;y--){if(N[y].selectorText==".md-clock"){var I=parseInt(N[y].style.height)}}}}var L=I/2,O=L-32,P=20,F=L*2,V=350;var z=v._24h?25:13;for(var y=1,H="",J;y<z;y++){J=y/6*Math.PI;if(v._24h&&y<13){H+=d(L,J,P,y,.6)}else{H+=d(L,J,P,y,1)}}for(var y=0,Y="",J;y<60;y+=5){J=y/30*Math.PI;Y+=d(L,J,P,y.pad(2),1)}var j=""+'<div class="md-datepicker-timeview">'+'<div class="md-datepick-header">'+'<div class="md-datepicker-headline">'+'<span class="md-hour"></span>'+":"+'<span class="md-minute"></span>'+'<div class="md-ampm-toggle">'+'<span class="md-am">AM</span>'+'<span class="md-pm">PM</span>'+"</div>"+"</div>"+'<i class="md-toggle-state no-hover">event</i>'+"</div>"+'<div class="md-clock">'+'<div class="md-hours">'+H+"</div>"+'<div class="md-minutes">'+Y+"</div>"+"</div>"+"</div>",W="http://www.w3.org/2000/svg";var $=i("svg");$.setAttribute("class","lolliclock-svg");$.setAttribute("width",F);$.setAttribute("height",F);var X=i("g");X.setAttribute("transform","translate("+L+","+L+")");var B=i("circle");B.setAttribute("class","lolliclock-bearing");B.setAttribute("cx",0);B.setAttribute("cy",0);B.setAttribute("r",5);var q=i("line");q.setAttribute("x1",0);q.setAttribute("y1",0);var K=i("circle");K.setAttribute("class","lolliclock-canvas-bg");K.setAttribute("r",20);var Q=i("circle");Q.setAttribute("class","lolliclock-canvas-fg");Q.setAttribute("r",3.5);X.appendChild(q);X.appendChild(K);X.appendChild(Q);X.appendChild(B);$.appendChild(X);var R=function(t){var s=ce.offset(),n=/^touch/.test(t.type),i=s.left+L,d=s.top+L,r=(n?t.originalEvent.touches[0]:t).pageX-i,l=(n?t.originalEvent.touches[0]:t).pageY-d,o=Math.sqrt(r*r+l*l),c=false;if(o<O-P||o>O+P){return}t.preventDefault();e(a.body).addClass("lolliclock-moving");ce.append(self.canvas);U(r,l);e(a).off(m).on(m,function(e){e.preventDefault();var t=/^touch/.test(e.type),a=(t?e.originalEvent.touches[0]:e).pageX-i,s=(t?e.originalEvent.touches[0]:e).pageY-d;if(!c&&a===r&&s===l){return}c=true;U(a,s)});e(a).off(p).on(p,function(t){t.preventDefault();var s=/^touch/.test(t.type),n=(s?t.originalEvent.changedTouches[0]:t).pageX-i,o=(s?t.originalEvent.changedTouches[0]:t).pageY-d;if(n===r&&o===l){U(n,o)}if(oe.currentView==="hours"){ae(true)}else if(v.autoclose){}e(a.body).removeClass("lolliclock-moving");e(a).off(m);e(a).off(p)})}}var G='<div class="md-datepicker md-'+v.theme.split(" ").join(" md-")+(v.animated=="all"||v.animated=="inout"||v.animated?" md-datepicker-animated":"")+(v.custom_class!=""?" "+v.custom_class:"")+'" id="md-datepicker-'+id.pad(3)+'">'+'<div class="md-datepicker-views">'+'<div class="md-datepicker-dateview">'+'<div class="md-datepick-header">'+"<div>"+'<span class="year"></span>'+"</div>"+'<div class="md-datepicker-headline">'+'<span class="weekday"></span><span class="day"></span> <span class="month"></span>'+"</div>"+(v.timepicker?'<i class="md-toggle-state no-hover">access_time</i>':"")+"</div>"+'<div class="md-datepick-month">'+'<i class="md-previous md-touchtarget no-hover">navigate_before</i><i class="md-next md-touchtarget no-hover">navigate_next</i>'+"</div>"+'<div class="md-months">'+'<div class="md-previous-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+D+"</div>"+'<div class="md-week">'+_+"</div>"+"</div>"+'<div class="md-current-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+D+"</div>"+'<div class="md-week">'+_+"</div>"+"</div>"+'<div class="md-next-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+D+"</div>"+'<div class="md-week">'+_+"</div>"+"</div>"+"</div>"+'<div class="month-select md-select-wrap">'+T+"</div>"+'<div class="year-select md-select-wrap">'+E+"</div>"+"</div>"+(v.timepicker?j:"")+"</div>"+'<div class="md-buttons">'+'<div class="md-button-flat button-delete">Löschen</div>'+'<div class="md-button-flat button-cancel">Abbrechen</div>'+'<div class="md-button-flat button-ok">OK</div>'+"</div>"+"</div>";var U=function(t,a){var s=Math.atan2(-t,a)+Math.PI;var n=oe.currentView==="hours";var i=Math.PI/(n?6:30);var d;d=Math.round(s/i);s=d*i;if(n){if(d===0){d=12}oe.fg.style.visibility="hidden";oe.el.hour.text(oe.hasClass("pm")?d+12==24?12:(d+12).pad(2):d==12?"00":d.pad(2));oe.date.setHours(oe.el.hour.text())}else{var r=d%5===0;if(r){oe.fg.style.visibility="hidden"}else{oe.fg.style.visibility="visible"}if(d===60){d=0}oe.el.minute.text(d.pad(2));oe.date.setMinutes(oe.el.minute.text())}var l=oe.currentView=="hours"?oe.ticks.hours:oe.ticks.minutes;l.each(function(t,a){e(a).toggleClass("active",e(a).text()==d)});oe.g.insertBefore(oe.hand,oe.bearing);oe.g.insertBefore(oe.bg,oe.fg);oe.bg.setAttribute("class","lolliclock-canvas-bg");var o=Math.sin(s)*O,c=-Math.cos(s)*O;oe.hand.setAttribute("x2",Math.sin(s)*(O-P));oe.hand.setAttribute("y2",-Math.cos(s)*(O-P));oe.bg.setAttribute("cx",o);oe.bg.setAttribute("cy",c);oe.fg.setAttribute("cx",o);oe.fg.setAttribute("cy",c)};var Z=function(a){var s=e(a).offset(),n=oe.width(),i=oe.height();s.top=s.top+i+8>=t.innerHeight?t.innerHeight-i-8:s.top;s.left=s.left+n+8>=t.innerWidth?t.innerWidth-n-8:s.left;return s};this.show=function(a){var n=a.value!=""?v.format?moment(a.value,v.format):moment(a.value):moment(),i=Z(a);oe.date=new Date(n);oe.set=oe.start==a?"start":"end";oe.date=isNaN(oe.date.getTime())?new Date:oe.date;oe.range=de();oe.el.prev_next_btns.removeClass("disabled");re("current");re("previous");re("next");te();if(v.animated){oe.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){oe.addClass("animate");oe.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")});if(oe.hasClass("clockpicker")){oe.removeClass("clockpicker");oe.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",".md-datepicker-views",function(t){t.preventDefault();e(oe).css({top:i.top,left:i.left}).off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")})}else{e(oe).css({top:i.top,left:i.left}).addClass("md-datepicker-visible")}}else{e(oe).css({top:i.top,left:i.left}).addClass("md-datepicker-visible")}oe.el.buttons.off();oe.el.buttons.on("click",".button-ok",function(t){t.preventDefault();if(e(a).is("[type=date]")){e(a).val(oe.date.g(1)+"-"+(oe.date.g(2)+1).pad(2)+"-"+oe.date.g(3).pad(2)).change()}else if(v.format){e(a).val(moment(oe.date).format(v.format)).change()}else if(v.timepicker){e(a).val(oe.date.toLocaleString()).change()}else{e(a).val(oe.date.toLocaleDateString()).change()}oe[oe.set].date=oe.date;a.date=oe.date;ee(a)});oe.el.buttons.on("click",".button-delete",function(t){t.preventDefault();a.date=s;e(a).val("").change();ee(a)});oe.el.buttons.children(".button-delete").toggleClass("disabled",a.value=="");oe.el.buttons.on("click",".button-cancel",function(e){e.preventDefault();ee(a)});var d;e(t).on("resize",function(e){clearTimeout(d);i=Z(a);oe.css({top:i.top,left:i.left}).removeClass("animate");d=setTimeout(function(){oe.addClass("animate")},100)})};var ee=function(a){e(a).removeClass("focused");oe.removeClass("clockpicker md-datepicker-visible animate");oe.el.buttons.off();e(t).off("resize")};var te=function(){if(de()){var t=oe.set=="start"?"end":"start";var a=e(".md-select-wrap>span:matches("+oe[t].date.g(1)+")");if(oe.start.date&&oe.start.date.g(1)==oe.date.g(1)&&t=="start"||oe.end.date&&oe.end.date.g(1)==oe.date.g(1)&&t=="end"){e(oe.el.prev_next_btns[oe.set=="start"|0]).toggleClass("disabled",oe[t].date.g(2)==oe.date.g(2));a.push(e(".md-select-wrap>span[data-month="+oe[t].date.g(2)+"]")[0]);oe.find(".md-select-wrap>span").removeClass("disabled");if(oe.set=="end"){e(a[1]).prevAll().addClass("disabled");e(a[0]).nextAll().addClass("disabled")}else{e(a[0]).prevAll().addClass("disabled");e(a[1]).nextAll().addClass("disabled")}}}else{oe.find(".md-select-wrap>span").removeClass("disabled")}oe.el.months.text(oe.date.loc(v.language,{month:"long"}));oe.el.years.text(oe.date.g(1));oe.el.days.text(oe.date.g(3));oe.el.weekday.text(oe.date.loc(v.language,{weekday:"short"}).replace(".",""));if(v.timepicker){oe.removeClass("minute");oe.currentView="hours";oe.toggleClass("pm",oe.date.g(4)>=12);oe.el.hour.text(oe.date.g(4).pad(2));oe.el.minute.text(oe.date.g(5).pad(2));var s=oe.date.g(4)*(Math.PI/6),n=Math.sin(s)*O,i=-Math.cos(s)*O;U(n,i)}};var ae=function(t){oe.toggleClass("minute",!e(t.target).is(".md-hour"));oe.currentView=!e(t.target).is(".md-hour")?"minutes":"hours";var a=(!e(t.target).is(".md-hour")?oe.el.minute.text():oe.el.hour.text())*(Math.PI/(oe.currentView==="hours"?6:30)),s=Math.sin(a)*O,n=-Math.cos(a)*O;U(s,n)};var se=function(t){var a=t=="year"?e(".md-select-wrap>span:matches("+oe.date.g(1)+")"):e(".md-select-wrap>span[data-month="+oe.date.g(2)+"]");if(!a.length){var s=oe.date.g(1)-Number(oe.el.select_year.children(":first-child").text());for(var n=1,i=Number(oe.el.select_year.children(":first-child").text());n<=s;n++){oe.el.select_year.prepend("<span>"+(i+n)+"</span>")}a=e(".md-select-wrap>span:matches("+oe.date.g(1)+")")}var d=a.position().top;oe.el["select_"+t].children("span").removeClass("md-currentdate");if(t=="year")e(".md-select-wrap>span:matches("+oe.date.g(1)+")").addClass("md-currentdate");else e(".md-select-wrap>span[data-month="+oe.date.g(2)+"]").addClass("md-currentdate");oe.el["select_"+t].addClass("inview animate");oe.el["select_"+t].stop().animate({scrollTop:d+oe.el["select_"+t][0].scrollTop-(oe.el["select_"+t][0].clientHeight-48)/2},parseInt(Math.abs(d.remap(0,2e3,500,3e3))),"easeInOutExpo");oe.el["select_"+t].on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){oe.el["select_"+t].removeClass("animate")});oe.el["select_"+t].on("mousewheel",function(e){oe.el["select_"+t].stop()})};var ne=function(e){var t=oe.range?e=="next"?oe.set=="start"&&oe.date.g(2)<oe.end.date.g(2)||oe.set=="start"&&oe.date.g(1)!=oe.end.date.g(1)||oe.set=="end":oe.set=="end"&&oe.date.g(2)>oe.start.date.g(2)||oe.set=="end"&&oe.date.g(1)!=oe.start.date.g(1)||oe.set=="start":true;var a=oe.set=="start"?"end":"start";if(t){oe.el.prev_next_btns.off("click");oe.el.month_wrap.addClass("animate "+e);if(e=="next"){oe.date.setMonth(oe.date.g(2)+1)}else{oe.date.setMonth(oe.date.g(2)-1)}if(oe.range&&oe.set=="start"&&oe.end.date<=oe.date||oe.range&&oe.set=="end"&&oe.start.date>=oe.date){oe.date=new Date(oe[a].date);ie()}te();oe.el.month_wrap.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){oe.el.current.html(oe.el[e].html());oe.el.month_wrap.removeClass("animate "+e);re("next");re("previous");oe.el.month_wrap.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");oe.el.prev_next_btns.on("click",le)})}};var ie=function(){var e=["next","previous"];for(var t=e.length-1;t>=0;t--){console.log(oe.el[e[t]]);oe.el[e[t]].find(".md-selecteddate").removeClass("md-selecteddate");oe.el[e[t]].find("span:matches("+oe.date.g(3)+")").addClass("md-selecteddate")}};function de(){if(oe.start&&oe.end){return oe.date!=s&&oe[oe.set=="start"?"end":"start"].date!=s}else return false}var re=function(e){var t=oe.date.g(2),a=new Date(oe.date),s,n="",i;if(e=="previous"){a.setMonth(t-1)}else if(e=="next"){a.setMonth(t+1)}s=f[startDay(a)];var d=daysInMonth(a);for(var r=v.startday;r<s+v.startday;r++){n+="<span></span>"}var l=h.g(2)==a.g(2)&&h.g(1)==a.g(1),o=oe.set=="start"?"end":"start";if(oe.range)var c=a.g(2)==oe[o].date.g(2)&&a.g(1)==oe[o].date.g(1);for(var r=1;r<=d;r++){i=[];if(oe.date.g(3)==r)i.push("md-selecteddate");if(h.g(3)==r&&l)i.push("md-currentdate");if(oe.range&&oe.set=="start"&&r>oe.end.date.g(3)&&c||oe.range&&oe.set=="end"&&r<oe.start.date.g(3)&&c)i.push("disabled");n+="<span"+(i.length>=1?' class="'+i.join(" ")+'"':"")+" >"+r+"</span>"}oe.el[e].find(".md-month-display").text(a.loc(v.language,{month:"long"}));oe.el[e].find(".md-year-display").text(a.g(1));oe.el[e].find(".md-week").html(n)};function le(){ne(this.className.split(" ")[0].split("-")[1])}var oe=e(G).appendTo("body");oe.el={};if(v.timepicker){var ce=oe.find(".md-clock");ce.append($);oe.hand=q;oe.bg=K;oe.fg=Q;oe.bearing=B;oe.g=X;oe.canvas=ce;oe.ticks={};oe.ticks.minutes=oe.canvas.find(".md-minutes>div");oe.ticks.hours=oe.canvas.find(".md-hours>div");oe.el.hour=oe.find(".md-hour");oe.el.minute=oe.find(".md-minute");oe.el.ampm=oe.find(".md-ampm-toggle");oe.currentView="hours";ce.on(u,R)}oe.el.years=oe.find(".year");oe.el.months=oe.find(".month");oe.el.days=oe.find(".day");oe.el.buttons=oe.find(".md-buttons");oe.el.weekday=oe.find(".weekday");oe.el.month_wrap=oe.find(".md-months");oe.el.current=oe.find(".md-current-month");oe.el.next=oe.find(".md-next-month");oe.el.prev_next_btns=oe.find(".md-next").add(oe.find(".md-previous"));oe.el.select_month=oe.find(".month-select");oe.el.select_year=oe.find(".year-select");oe.el.previous=oe.find(".md-previous-month");oe.el.prev_next_btns.on("click",le);oe.on("click",".month-select>span, .year-select>span",function(t){if(e(this).data("month")===s){oe.date.setYear(e(this).text());oe.el["select_year"].off()}else{oe.date.setMonth(e(this).data("month"));oe.el["select_month"].off()}if(oe.range){if(oe.set=="start"&&oe.end.date<=oe.date||oe.set=="end"&&oe.start.date>=oe.date){var a=oe.set=="start"?"end":"start";oe.date=new Date(oe[a].date)}}te();re("current");e(this).parents(".md-select-wrap").addClass("animate").removeClass("inview").off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");re("previous");re("next")});oe.el.months.on("click",function(e){se("month")});oe.el.years.on("click",function(e){se("year")});oe.on("click",".md-week span",function(t){e(".md-selecteddate").removeClass("md-selecteddate");oe.el.month_wrap.find("span:matches("+e(this).text()+")").addClass("md-selecteddate");oe.date.setDate(e(this).text());te()});oe.on("click",".md-toggle-state",function(e){oe.toggleClass("clockpicker",!oe.hasClass("clockpicker"))});oe.on("click",".md-minute, .md-hour",function(e){ae(e)});oe.on("click",".md-pm, .md-am",function(t){oe.toggleClass("pm",!e(t.target).is(".md-am"));var a=parseInt(oe.el.hour.text());a=oe.hasClass("pm")?a+12==24?12:a+12:a==0?0:a-12;oe.el.hour.text(a.pad(2));oe.date.setHours(a.pad(2))});var ue=this,me=[];return this.each(function(){this.initilized=true;e(this).on("focus",function(t){t.preventDefault();e(me).removeClass("focused");e(t.target).addClass("focused");ue.show(t.target)});me.push(this);if(e(this).is("[data-md-start]"))oe.start=this;if(e(this).is("[data-md-end]"))oe.end=this}).promise().done(function(){oe.state="ready";if(me.length>2&&oe.start){throw new Error("Only one start and one end Date is allowed")}oe.container=me})};e.fn.md_datepicker.version="1.4.1-dev"})(jQuery,window,document);function daysInMonth(e){return new Date(e.g(1),e.g(2)+1,0).g(3)}function startDay(e){return new Date(e.g(1),e.g(2),1).g()}Number.prototype.remap=function(e,t,a,s){return a+(this-e)*(s-a)/(t-e)};Date.prototype.g=function(e){return e==1?this.getFullYear():e==2?this.getMonth():e==4?this.getHours():e==5?this.getMinutes():e==3?this.getDate():this.getDay()};Date.prototype.loc=function(e,t){if(Date.prototype.toLocaleString!=undefined){return this.toLocaleString(e,t)}else{return locale[e][Object.keys(t)[0]][this.g(t.weekday?0:2)]}};Number.prototype.pad=function(e){var t=String(this);while(t.length<(e||2)){t="0"+t}return t};String.prototype.pad=function(e){var t=String(this);while(t.length<(e||2)){t="0"+t}return t};$.expr[":"].matches=$.expr.createPseudo(function(e){return function(t){return $(t).text().match("^"+e+"$")}});
