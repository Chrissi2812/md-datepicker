function n(t){return new Date(t.k().year,t.k().month+1,0).k().day}function o(t){return new Date(t.k().year,t.k().month,1).k().weekday}function e(){try{(new Date).toLocaleString("i")}catch(t){return"RangeError"===t.name}return!1}var a=0,t={en:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],weekday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g:{h:"delete",i:"cancel"}},de:{month:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekday:["So","Mo","Di","Mi","Do","Fr","Sa"],g:{h:"Löschen",i:"Abrrechen"}}},s=["moz","ms","webkit","o"];!function($,d,i,r){function l(){var e=i.createElement("div").style;if(e.flex!=r)return!0;for(var t=s.length-1;t>=0;t--)if(e[s[t]+"Flex"]!=r)return!0;return!1}$.fn.md_datepicker=function(yt){"use strict";function w(t){return i.createElementNS(pt,t)}function T(t,e,a,n,s){return'<div class="lolliclock-tick" style="left:'+(t+Math.sin(e)*(u*s)-a).toFixed(2)+"px;top:"+(t-Math.cos(e)*(u*s)-a).toFixed(2)+'px">'+n+"</div>"}function nt(){return s.start&&s.end?s.o!=r&&s["start"==s.set?"end":"start"].o!=r:!1}function st(){ft(this.className.split(" ")[0].split("-")[1])}if(!l())return $(this).each(function(e,t){try{t.type="date"}catch(e){t.type="text"}});a++;var tt=!1;if(this.each(function(){this.j&&(tt=!0)}),!tt){var ut={language:null,theme:"light",timepicker:!1,startday:1,autoclose:!1,mindate:null,maxdate:null,range:"past",_24h:!1,format:null,animated:!0,submit:"string",custom_class:""},kt=e(),j="ontouchstart"in d,mt="mousedown"+(j?" touchstart":""),V="mousemove.lolliclock"+(j?" touchmove.lolliclock":""),J="mouseup.lolliclock"+(j?" touchend.lolliclock":""),v="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",f=new Date,c=$.extend({},ut,yt),P=[0,1,2,3,4,5,6],L=P.splice(-c.startday),P=L.concat(P);if(c.language=c.language?c.language:navigator.language||navigator.userLanguage||"en",f.setSeconds(0),c.format){var it=c.format.match(/\W/),rt=c.format.split(" ")[0].split(it).reverse();$.each(c.format.split(" ")[1].split(":"),function(e,t){rt.push(t)})}if(kt){for(var x,m=0,A=[];7>m;m++)x=new Date(2015,1,m),A[x.k().weekday]=x.toLocaleString(c.language,{weekday:"short"}).replace(".","");for(var x,m=0,I=[];12>m;m++)x=new Date(2015,m,1),I[m]=x.toLocaleString(c.language,{month:"long"})}else var A=t[c.language.split("-")[0]].weekday.slice(0),I=t[c.language.split("-")[0]].month.slice(0);L=A.splice(0,c.startday);var wt=A.concat(L),S="",_="",Y="";$.each(wt,function(e,t){_+="<span>"+t+"</span>"}),$.each(I,function(t,e){Y+='<span data-month="'+t+'">'+I[t]+"</span>"});var k=100,B=c.mindate&&c.mindate.search(/^[-+]/)?moment(c.mindate):moment().add(c.mindate,"y"),O=c.maxdate&&c.maxdate.search(/^[-+]/)?moment(c.maxdate):moment().add(c.maxdate,"y");c.mindate&&c.maxdate?(k=moment.duration(O-B).years(),c.range="calculated"):c.mindate&&"past"==c.range?k=moment.duration(f-B).years()+1:c.maxdate&&"future"==c.range&&(k=moment.duration(O-f).years());for(var x,m=0,Q="",N=c.range,F=f.k().year;k>=m;m++)Q+="<span>"+("future"==N?F+k-m:"past"==N?F-m:"calculated"==N?O.year()-m:F-(m-(k-k%2)/2))+"</span>";var bt=$(this);bt.each(function(){var t=this.cloneNode(!0);t.type="hidden",t.className="",t.l=this,t.id=this.id+"-timestamp",this.readOnly=!0,"timestamp"==c.submit?this.name="":t.name="",this.m=t,this.parentNode.appendChild(t),this.onchange=function(t){""!=this.value?(this.m.value=moment(this.value,c.format).unix(),this.o=new Date(moment(this.value,c.format).unix())):(this.m.value=0,this.m.o=r)},this.m.onchange=function(s){var e=Number(1e3*this.value),a=t.l.onchange;t.l.onchange=null,""==this.value?(t.l.value="",t.l.o=r):(t.l.value=moment(e).format(c.format),t.l.o=new Date(e)),$(t.l).change(),t.l.onchange=a}});for(var m=1;31>=m;m++)S+="<span>"+m+"</span>";if(c.timepicker){for(var m=i.styleSheets.length-1;m>=0;m--)if(i.styleSheets[m].href&&i.styleSheets[m].href.indexOf("md-datepicker")>0)for(var H=i.styleSheets[m].cssRules,m=H.length-1;m>=0;m--)if(".md-clock"==H[m].selectorText)var vt=parseInt(H[m].style.height);for(var C,h=vt/2,u=h-32,g=20,Z=2*h,ct=c._24h?25:13,m=1,K="";ct>m;m++)C=m/6*Math.PI,K+=c._24h&&13>m?T(h,C,g,m,.6):T(h,C,g,m,1);for(var C,m=0,z="";60>m;m+=5)C=m/30*Math.PI,z+=T(h,C,g,m.pad(2),1);var ht='<div class="md-datepicker-timeview"><div class="md-datepick-header"><div class="md-datepicker-headline"><span class="md-hour"></span>:<span class="md-minute"></span><div class="md-ampm-toggle"><span class="md-am">AM</span><span class="md-pm">PM</span></div></div><i class="md-toggle-state no-hover">&#xE878</i></div><div class="md-clock"><div class="md-hours">'+K+'</div><div class="md-minutes">'+z+"</div></div></div>",pt="http://www.w3.org/2000/svg",ot=w("svg").p({class:"lolliclock-svg",width:Z,height:Z}),y=w("g").p({transform:"translate("+h+","+h+")"}),G=w("circle").p({class:"lolliclock-bearing",cx:0,cy:0,r:5}),W=w("line").p({x1:0,y1:0}),X=w("circle").p({class:"lolliclock-canvas-bg",r:20}),R=w("circle").p({class:"lolliclock-canvas-fg",r:3.5});y.appendChild(W),y.appendChild(X),y.appendChild(R),y.appendChild(G),ot.appendChild(y);var dt=function(t){var r=M.offset(),d=/^touch/.test(t.type),n=r.left+h,o=r.top+h,e=(d?t.originalEvent.touches[0]:t).pageX-n,a=(d?t.originalEvent.touches[0]:t).pageY-o,l=Math.sqrt(e*e+a*a),m=!1;u-g>l||l>u+g||(t.preventDefault(),$(i.body).addClass("lolliclock-moving"),M.append(self.canvas),b(e,a),$(i).off(V).on(V,function(t){t.preventDefault();var s=/^touch/.test(t.type),i=(s?t.originalEvent.touches[0]:t).pageX-n,r=(s?t.originalEvent.touches[0]:t).pageY-o;(m||i!==e||r!==a)&&(m=!0,b(i,r))}),$(i).off(J).on(J,function(t){t.preventDefault();var r=/^touch/.test(t.type),d=(r?t.originalEvent.changedTouches[0]:t).pageX-n,l=(r?t.originalEvent.changedTouches[0]:t).pageY-o;d===e&&l===a&&b(d,l),"hours"===s.currentView?et(!0):c.autoclose,$(i.body).removeClass("lolliclock-moving"),$(i).off(V),$(i).off(J)}))}}var lt='<div class="md-datepicker md-'+c.theme.split(" ").join(" md-")+("all"==c.animated||"inout"==c.animated||c.animated?" md-datepicker-animated":"")+(""!=c.custom_class?" "+c.custom_class:"")+'" id="md-datepicker-'+a.pad(3)+'"><div class="md-datepicker-views"><div class="md-datepicker-dateview"><div class="md-datepick-header"><div><span class="year"></span></div><div class="md-datepicker-headline"><span class="weekday"></span><span class="day"></span> <span class="month"></span></div>'+(c.timepicker?'<i class="md-toggle-state no-hover">&#xE192;</i>':"")+'</div><div class="md-datepick-month"><i class="md-previous md-touchtarget no-hover">&#xE408;</i><i class="md-next md-touchtarget no-hover">&#xE409;</i></div><div class="md-months"><div class="md-previous-month md-month"><div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div><div class="md-weekday">'+_+'</div><div class="md-week">'+S+'</div></div><div class="md-current-month md-month"><div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div><div class="md-weekday">'+_+'</div><div class="md-week">'+S+'</div></div><div class="md-next-month md-month"><div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div><div class="md-weekday">'+_+'</div><div class="md-week">'+S+'</div></div></div><div class="month-select md-select-wrap">'+Y+'</div><div class="year-select md-select-wrap">'+Q+"</div></div>"+(c.timepicker?ht:"")+'</div><div class="md-buttons"><div class="md-button-flat button-delete">'+t[c.language.split("-")[0]].g.h+'</div><div class="md-button-flat button-cancel">'+t[c.language.split("-")[0]].g.i+'</div><div class="md-button-flat button-ok">OK</div></div></div>',b=function(r,d){var t,e=Math.atan2(-r,d)+Math.PI,a="hours"===s.currentView,n=Math.PI/(a?6:30);if(t=Math.round(e/n),e=t*n,a)0===t&&(t=12),s.q.style.visibility="hidden",s.t.s.text(s.hasClass("pm")?t+12==24?12:(t+12).pad(2):12==t?"00":t.pad(2)),s.o.setHours(s.t.s.text());else{var l=t%5===0;l?s.q.style.visibility="hidden":s.q.style.visibility="visible",60===t&&(t=0),s.t.u.text(t.pad(2)),s.o.setMinutes(s.t.u.text())}var c="hours"==s.currentView?s.v.hours:s.v.minutes;c.each(function(a,e){$(e).toggleClass("active",$(e).text()==t)}),s.A.insertBefore(s.B,s.C),s.A.insertBefore(s.D,s.q),s.D.setAttribute("class","lolliclock-canvas-bg");var o=Math.sin(e)*u,i=-Math.cos(e)*u;s.B.p({x2:Math.sin(e)*(u-g),y2:-Math.cos(e)*(u-g)}),s.D.p({cx:o,cy:i}),s.q.p({cx:o,cy:i})},U=function(n){var t=$(n).offset(),e=s.width(),a=s.height();return t.top=t.top+a+8>=d.innerHeight?d.innerHeight-a-8:t.top,t.left=t.left+e+8>=d.innerWidth?d.innerWidth-e-8:t.left,t};this.show=function(t){s.set=s.start==t?"start":"end";var n=""!=t.value?c.format?moment(t.value,c.format):moment(t.value):moment("start"==s.set?s.end.o:s.start.o),e=U(t);s.o=new Date(n),s.o=isNaN(s.o.getTime())?new Date:s.o,s.range=nt(),s.t.F.removeClass("disabled"),p("current"),p("previous"),p("next"),D(),c.animated?(s.on(v,function(){s.addClass("animate"),s.off(v)}),s.hasClass("clockpicker")?(s.removeClass("clockpicker"),s.on(v,".md-datepicker-views",function(t){t.preventDefault(),$(s).css({top:e.top,left:e.left}).off(v)})):$(s).css({top:e.top,left:e.left}).addClass("md-datepicker-visible")):$(s).css({top:e.top,left:e.left}).addClass("md-datepicker-visible"),s.t.buttons.off(),s.t.buttons.on("click",".button-ok",function(e){e.preventDefault(),$(t).is("[type=date]")?$(t).val(s.o.k().year+"-"+(s.o.k().month+1).pad(2)+"-"+s.o.k().day.pad(2)).change():c.format?$(t).val(moment(s.o).format(c.format)).change():c.timepicker?$(t).val(s.o.toLocaleString()).change():$(t).val(s.o.toLocaleDateString()).change(),s[s.set].o=s.o,t.o=s.o,q(t)}),s.t.buttons.on("click",".button-delete",function(e){e.preventDefault(),t.o=r,$(t).val("").change(),q(t)}),s.t.buttons.children(".button-delete").toggleClass("disabled",""==t.value),s.t.buttons.on("click",".button-cancel",function(e){e.preventDefault(),q(t)});var a;$(d).on("resize",function(n){clearTimeout(a),e=U(t),s.css({top:e.top,left:e.left}).removeClass("animate"),a=setTimeout(function(){s.addClass("animate")},100)})};var q=function(t){$(t).removeClass("focused"),s.removeClass("clockpicker md-datepicker-visible animate"),s.t.buttons.off(),$(d).off("resize")},D=function(){if(nt()){var t="start"==s.set?"end":"start",e=$(".md-select-wrap>span:matches("+s[t].o.k().year+")");(s.start.o&&s.start.o.k().year<=s.o.k().year&&"start"==t||s.end.o&&s.end.o.k().year>=s.o.k().year&&"end"==t)&&($(s.t.F["start"==s.set|0]).toggleClass("disabled",s.o.k().year==s[t].o.k().year&&s[t].o.k().month==s.o.k().month),s.o.k().year==s[t].o.k().year&&e.push($(".md-select-wrap>span[data-month="+s[t].o.k().month+"]")[0]),s.find(".md-select-wrap>span").removeClass("disabled"),"end"==s.set?($(e[1]).prevAll().addClass("disabled"),$(e[0]).nextAll().addClass("disabled")):($(e[0]).prevAll().addClass("disabled"),$(e[1]).nextAll().addClass("disabled")))}else s.find(".md-select-wrap>span").removeClass("disabled");if(s.t.G.text(s.o.H(c.language,{month:"long"})),s.t.years.text(s.o.k().year),s.t.I.text(s.o.k().day),s.t.weekday.text(s.o.H(c.language,{weekday:"short"}).replace(".","")),c.timepicker){s.removeClass("minute"),s.currentView="hours",s.toggleClass("pm",s.o.k().hours>=12),s.t.s.text(s.o.k().hours.pad(2)),s.t.u.text(s.o.k().minutes.pad(2));var a=s.o.k().hours*(Math.PI/6),n=Math.sin(a)*u,o=-Math.cos(a)*u;b(n,o)}},et=function(t){s.toggleClass("minute",!$(t.target).is(".md-hour")),s.currentView=$(t.target).is(".md-hour")?"hours":"minutes";var e=($(t.target).is(".md-hour")?s.t.s.text():s.t.u.text())*(Math.PI/("hours"===s.currentView?6:30)),a=Math.sin(e)*u,n=-Math.cos(e)*u;b(a,n)},at=function(t){var e=$("year"==t?".md-select-wrap>span:matches("+s.o.k().year+")":".md-select-wrap>span[data-month="+s.o.k().month+"]");if(!e.length){for(var o=s.o.k().year-Number(s.t.select_year.children(":first-child").text()),a=1,i=Number(s.t.select_year.children(":first-child").text());o>=a;a++)s.t.select_year.prepend("<span>"+(i+a)+"</span>");e=$(".md-select-wrap>span:matches("+s.o.k().year+")")}var n=e.position().top;s.t["select_"+t].children("span").removeClass("md-currentdate"),"year"==t?$(".md-select-wrap>span:matches("+s.o.k().year+")").addClass("md-currentdate"):$(".md-select-wrap>span[data-month="+s.o.k().month+"]").addClass("md-currentdate"),s.t["select_"+t].addClass("inview animate"),s.t["select_"+t].stop().animate({scrollTop:n+s.t["select_"+t][0].scrollTop-(s.t["select_"+t][0].clientHeight-48)/2},parseInt(Math.abs(n.J(0,2e3,500,3e3))),"easeInOutExpo"),s.t["select_"+t].on(v,function(){s.t["select_"+t].removeClass("animate")}),s.t["select_"+t].on("mousewheel",function(e){s.t["select_"+t].stop()})},ft=function(t){var e=s.range?"next"==t?"start"==s.set&&s.o.k().month<s.end.o.k().month||"start"==s.set&&s.o.k().year!=s.end.o.k().year||"end"==s.set:"end"==s.set&&s.o.k().month>s.start.o.k().month||"end"==s.set&&s.o.k().year!=s.start.o.k().year||"start"==s.set:!0,a="start"==s.set?"end":"start";e&&(s.t.F.off("click"),s.t.K.addClass("animate "+t),"next"==t?s.o.setMonth(s.o.k().month+1):s.o.setMonth(s.o.k().month-1),(s.range&&"start"==s.set&&s.end.o<=s.o||s.range&&"end"==s.set&&s.start.o>=s.o)&&(s.o=new Date(s[a].o),gt()),D(),s.t.K.on(v,function(){s.t.current.html(s.t[t].html()),s.t.K.removeClass("animate "+t),p("next"),p("previous"),s.t.K.off(v),s.t.F.on("click",st)}))},gt=function(){for(var e=["next","previous"],t=e.length-1;t>=0;t--)s.t[e[t]].find(".md-selecteddate").removeClass("md-selecteddate"),s.t[e[t]].find("span:matches("+s.o.k().day+")").addClass("md-selecteddate")},p=function(i){var d,a,l=s.o.k().month,t=new Date(s.o),r="";"previous"==i?t.setMonth(l-1):"next"==i&&t.setMonth(l+1),d=P[o(t)];for(var h=n(t),e=c.startday;e<d+c.startday;e++)r+="<span></span>";var p=f.k().month==t.k().month&&f.k().year==t.k().year,m="start"==s.set?"end":"start";if(s.range)var u=t.k().month==s[m].o.k().month&&t.k().year==s[m].o.k().year;for(var e=1;h>=e;e++)a=[],s.o.k().day==e&&a.push("md-selecteddate"),f.k().day==e&&p&&a.push("md-currentdate"),(s.range&&"start"==s.set&&e>s.end.o.k().day&&u||s.range&&"end"==s.set&&e<s.start.o.k().day&&u)&&a.push("disabled"),r+="<span"+(a.length>=1?' class="'+a.join(" ")+'"':"")+" >"+e+"</span>";s.t[i].find(".md-month-display").text(t.H(c.language,{month:"long"})),s.t[i].find(".md-year-display").text(t.k().year),s.t[i].find(".md-week").html(r)},s=$(lt).appendTo("body");if(s.t={},c.timepicker){var M=s.find(".md-clock");M.append(ot),$.extend(s,{B:W,D:X,q:R,C:G,A:y,canvas:M,v:{}}),s.v.minutes=s.canvas.find(".md-minutes>div"),s.v.hours=s.canvas.find(".md-hours>div"),s.t.s=s.find(".md-hour"),s.t.u=s.find(".md-minute"),s.t.L=s.find(".md-ampm-toggle"),s.currentView="hours",M.on(mt,dt)}s.t.years=s.find(".year"),s.t.G=s.find(".month"),s.t.I=s.find(".day"),s.t.buttons=s.find(".md-buttons"),s.t.weekday=s.find(".weekday"),s.t.K=s.find(".md-months"),s.t.current=s.find(".md-current-month"),s.t.next=s.find(".md-next-month"),s.t.F=s.find(".md-next").add(s.find(".md-previous")),s.t.select_month=s.find(".month-select"),s.t.select_year=s.find(".year-select"),s.t.previous=s.find(".md-previous-month"),s.t.F.on("click",st),s.on("click",".month-select>span, .year-select>span",function(e){if($(this).data("month")===r?(s.o.setYear($(this).text()),s.t.select_year.off()):(s.o.setMonth($(this).data("month")),s.t.select_month.off()),s.range&&("start"==s.set&&s.end.o<=s.o||"end"==s.set&&s.start.o>=s.o)){var t="start"==s.set?"end":"start";s.o=new Date(s[t].o)}D(),p("current"),$(this).parents(".md-select-wrap").addClass("animate").removeClass("inview").off(v),p("previous"),p("next")}),s.t.G.on("click",function(t){at("month")}),s.t.years.on("click",function(t){at("year")}),s.on("click",".md-week span",function(t){$(".md-selecteddate").removeClass("md-selecteddate"),s.t.K.find("span:matches("+$(this).text()+")").addClass("md-selecteddate"),s.o.setDate($(this).text()),D()}),s.on("click",".md-toggle-state",function(t){s.toggleClass("clockpicker",!s.hasClass("clockpicker"))}),s.on("click",".md-minute, .md-hour",function(t){et(t)}),s.on("click",".md-pm, .md-am",function(e){s.toggleClass("pm",!$(e.target).is(".md-am"));var t=parseInt(s.t.s.text());t=s.hasClass("pm")?t+12==24?12:t+12:0==t?0:t-12,s.t.s.text(t.pad(2)),s.o.setHours(t.pad(2))});var xt=this,E=[];return this.each(function(){this.j=!0,$(this).on("focus",function(t){t.preventDefault(),$(E).removeClass("focused"),$(t.target).addClass("focused"),xt.show(t.target)}),E.push(this),$(this).is("[data-md-start]")&&(s.start=this),$(this).is("[data-md-end]")&&(s.end=this)}).promise().done(function(){if(s.state="ready",E.length>2&&s.start)throw new Error("Only one start and one end Date is allowed");s.M=E})}}}(jQuery,window,document),Number.prototype.J=function(t,a,e,s){return e+(this-t)*(s-e)/(a-t)},Date.prototype.k=function(){return{year:this.getFullYear(),month:this.getMonth(),hours:this.getHours(),minutes:this.getMinutes(),day:this.getDate(),weekday:this.getDay()}},Date.prototype.H=function(s,a){return e()?this.toLocaleString(s,a):t[s.split("-")[0]][Object.keys(a)[0]][this.k()[Object.keys(a)]]},Element.prototype.p=function(e){"use strict";for(var t in e)e.hasOwnProperty(t)&&(this instanceof SVGElement||(this[t]=e[t]),this[t]!=e[t]&&this.setAttribute(t,e[t]));return this},Number.prototype.pad=function(e){for(var t=String(this);t.length<(e||2);)t="0"+t;return t},String.prototype.pad=function(e){for(var t=String(this);t.length<(e||2);)t="0"+t;return t},$.expr[":"].matches=$.expr.createPseudo(function(t){return function(e){return $(e).text().match("^"+t+"$")}});
