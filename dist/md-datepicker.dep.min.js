var id=0;(function(e,t,a,s){e.fn.md_datepicker=function(n){"use strict";function i(e){return a.createElementNS(F,e)}function d(e,t,a,s,n){return'<div class="lolliclock-tick" style="left:'+(e+Math.sin(t)*(L*n)-a).toFixed(2)+"px;top:"+(e-Math.cos(t)*(L*n)-a).toFixed(2)+'px">'+s+"</div>"}id++;var r=false;this.each(function(){if(this.initilized)r=true});if(r)return;var l={language:null,theme:"light",timepicker:false,startday:1,autoclose:false,mindate:null,maxdate:null,color:null,_24h:false,format:null,animated:true,submit:"string",custom_class:""},o="ontouchstart"in t,c="mousedown"+(o?" touchstart":""),m="mousemove.lolliclock"+(o?" touchmove.lolliclock":""),u="mouseup.lolliclock"+(o?" touchend.lolliclock":""),p=new Date,h=e.extend({},l,n),v=[0,1,2,3,4,5,6],f=v.splice(-h.startday),v=f.concat(v);h.language=h.language?h.language:navigator.language||navigator.userLanguage;p.setSeconds(0);if(h.format){var g=h.format.match(/\W/),b=h.format.split(" ")[0].split(g).reverse();e.each(h.format.split(" ")[1].split(":"),function(e,t){b.push(t)})}for(var k=0,w,y=[];k<7;k++){w=new Date(2015,1,k);y[w.g()]=w.toLocaleString(h.language,{weekday:"short"}).replace(".","")}f=y.splice(0,h.startday);var x=y.concat(f),C="",_="";e.each(x,function(e,t){_+="<span>"+t+"</span>"});for(var k=0,w,M=[],E="";k<12;k++){w=new Date(2015,k,1);M[k]=w.toLocaleString(h.language,{month:"long"});E+='<span data-month="'+k+'">'+M[k]+"</span>"}for(var k=0,w,T="",D=p.g(1);k<100;k++){T+="<span>"+(D-k)+"</span>"}var A=e(this);A.each(function(){var t=this.cloneNode(true);t.type="hidden";t.className="";t.output=this;this.readOnly=true;t.id=this.id+"-timestamp";if(h.submit=="timestamp"){this.name=""}else{t.name=""}this.timestamp=t;this.parentNode.appendChild(t);this.onchange=function(e){if(this.value!=""){this.timestamp.value=moment(this.value,h.format).unix();this.date=new Date(moment(this.value,h.format).unix())}else{this.timestamp.value=0;this.timestamp.date=s}};this.timestamp.onchange=function(a){var n=Number(this.value*1e3),i=t.output.onchange;t.output.onchange=null;if(this.value==""){t.output.value="";t.output.date=s}else{t.output.value=moment(n).format(h.format);t.output.date=new Date(n)}e(t.output).change();t.output.onchange=i}});for(var k=1;k<=31;k++){C+="<span>"+k+"</span>"}if(h.timepicker){for(var k=a.styleSheets.length-1;k>=0;k--){if(a.styleSheets[k].href&&a.styleSheets[k].href.indexOf("md-datepicker")>0){var S=a.styleSheets[k].cssRules;for(var k=S.length-1;k>=0;k--){if(S[k].selectorText==".md-clock"){var I=parseInt(S[k].style.height)}}}}var N=I/2,L=N-32,P=20,V=N*2,H=350;var O=h._24h?25:13;for(var k=1,Y="",z;k<O;k++){z=k/6*Math.PI;if(h._24h&&k<13){Y+=d(N,z,P,k,.6)}else{Y+=d(N,z,P,k,1)}}for(var k=0,$="",z;k<60;k+=5){z=k/30*Math.PI;$+=d(N,z,P,k.pad(2),1)}var j=""+'<div class="md-datepicker-timeview">'+'<div class="md-datepick-header">'+'<div class="md-datepicker-headline">'+'<span class="md-hour"></span>'+":"+'<span class="md-minute"></span>'+'<div class="md-ampm-toggle">'+'<span class="md-am">AM</span>'+'<span class="md-pm">PM</span>'+"</div>"+"</div>"+'<i class="md-toggle-state no-hover">event</i>'+"</div>"+'<div class="md-clock">'+'<div class="md-hours">'+Y+"</div>"+'<div class="md-minutes">'+$+"</div>"+"</div>"+"</div>",F="http://www.w3.org/2000/svg";var W=i("svg");W.setAttribute("class","lolliclock-svg");W.setAttribute("width",V);W.setAttribute("height",V);var X=i("g");X.setAttribute("transform","translate("+N+","+N+")");var B=i("circle");B.setAttribute("class","lolliclock-bearing");B.setAttribute("cx",0);B.setAttribute("cy",0);B.setAttribute("r",5);var q=i("line");q.setAttribute("x1",0);q.setAttribute("y1",0);var K=i("circle");K.setAttribute("class","lolliclock-canvas-bg");K.setAttribute("r",20);var Q=i("circle");Q.setAttribute("class","lolliclock-canvas-fg");Q.setAttribute("r",3.5);X.appendChild(q);X.appendChild(K);X.appendChild(Q);X.appendChild(B);W.appendChild(X);var R=function(t){var s=oe.offset(),n=/^touch/.test(t.type),i=s.left+N,d=s.top+N,r=(n?t.originalEvent.touches[0]:t).pageX-i,l=(n?t.originalEvent.touches[0]:t).pageY-d,o=Math.sqrt(r*r+l*l),c=false;if(o<L-P||o>L+P){return}t.preventDefault();e(a.body).addClass("lolliclock-moving");oe.append(self.canvas);J(r,l);e(a).off(m).on(m,function(e){e.preventDefault();var t=/^touch/.test(e.type),a=(t?e.originalEvent.touches[0]:e).pageX-i,s=(t?e.originalEvent.touches[0]:e).pageY-d;if(!c&&a===r&&s===l){return}c=true;J(a,s)});e(a).off(u).on(u,function(t){t.preventDefault();var s=/^touch/.test(t.type),n=(s?t.originalEvent.changedTouches[0]:t).pageX-i,o=(s?t.originalEvent.changedTouches[0]:t).pageY-d;if(n===r&&o===l){J(n,o)}if(le.currentView==="hours"){te(true)}else if(h.autoclose){}e(a.body).removeClass("lolliclock-moving");e(a).off(m);e(a).off(u)})}}var G='<div class="md-datepicker md-'+h.theme.split(" ").join(" md-")+(h.animated=="all"||h.animated=="inout"||h.animated?" md-datepicker-animated":"")+(h.custom_class!=""?" "+h.custom_class:"")+'" id="md-datepicker-'+id.pad(3)+'">'+'<div class="md-datepicker-views">'+'<div class="md-datepicker-dateview">'+'<div class="md-datepick-header">'+"<div>"+'<span class="year"></span>'+"</div>"+'<div class="md-datepicker-headline">'+'<span class="weekday"></span><span class="day"></span> <span class="month"></span>'+"</div>"+(h.timepicker?'<i class="md-toggle-state no-hover">access_time</i>':"")+"</div>"+'<div class="md-datepick-month">'+'<i class="md-previous md-touchtarget no-hover">navigate_before</i><i class="md-next md-touchtarget no-hover">navigate_next</i>'+"</div>"+'<div class="md-months">'+'<div class="md-previous-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+_+"</div>"+'<div class="md-week">'+C+"</div>"+"</div>"+'<div class="md-current-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+_+"</div>"+'<div class="md-week">'+C+"</div>"+"</div>"+'<div class="md-next-month md-month">'+'<div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div>'+'<div class="md-weekday">'+_+"</div>"+'<div class="md-week">'+C+"</div>"+"</div>"+"</div>"+'<div class="month-select md-select-wrap">'+E+"</div>"+'<div class="year-select md-select-wrap">'+T+"</div>"+"</div>"+(h.timepicker?j:"")+"</div>"+'<div class="md-buttons">'+'<div class="md-button-flat button-delete">LÃ¶schen</div>'+'<div class="md-button-flat button-cancel">Abbrechen</div>'+'<div class="md-button-flat button-ok">OK</div>'+"</div>"+"</div>";var J=function(t,a){var s=Math.atan2(-t,a)+Math.PI;var n=le.currentView==="hours";var i=Math.PI/(n?6:30);var d;d=Math.round(s/i);s=d*i;if(n){if(d===0){d=12}le.fg.style.visibility="hidden";le.el.hour.text(le.hasClass("pm")?d+12==24?12:(d+12).pad(2):d==12?"00":d.pad(2));le.date.setHours(le.el.hour.text())}else{var r=d%5===0;if(r){le.fg.style.visibility="hidden"}else{le.fg.style.visibility="visible"}if(d===60){d=0}le.el.minute.text(d.pad(2));le.date.setMinutes(le.el.minute.text())}var l=le.currentView=="hours"?le.ticks.hours:le.ticks.minutes;l.each(function(t,a){e(a).toggleClass("active",e(a).text()==d)});le.g.insertBefore(le.hand,le.bearing);le.g.insertBefore(le.bg,le.fg);le.bg.setAttribute("class","lolliclock-canvas-bg");var o=Math.sin(s)*L,c=-Math.cos(s)*L;le.hand.setAttribute("x2",Math.sin(s)*(L-P));le.hand.setAttribute("y2",-Math.cos(s)*(L-P));le.bg.setAttribute("cx",o);le.bg.setAttribute("cy",c);le.fg.setAttribute("cx",o);le.fg.setAttribute("cy",c)};var U=function(a){var s=e(a).offset(),n=le.width(),i=le.height();s.top=s.top+i+8>=t.innerHeight?t.innerHeight-i-8:s.top;s.left=s.left+n+8>=t.innerWidth?t.innerWidth-n-8:s.left;return s};this.show=function(a){var n=a.value!=""?h.format?moment(a.value,h.format):moment(a.value):moment(),i=U(a);le.date=new Date(n);le.set=le.start==a?"start":"end";le.date=isNaN(le.date.getTime())?new Date:le.date;le.range=ie();le.el.prev_next_btns.removeClass("disabled");de("current");de("previous");de("next");ee();if(h.animated){le.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){le.addClass("animate");le.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")});if(le.hasClass("clockpicker")){le.removeClass("clockpicker");le.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",".md-datepicker-views",function(t){t.preventDefault();e(le).css({top:i.top,left:i.left}).off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")})}else{e(le).css({top:i.top,left:i.left}).addClass("md-datepicker-visible")}}else{e(le).css({top:i.top,left:i.left}).addClass("md-datepicker-visible")}le.el.buttons.off();le.el.buttons.on("click",".button-ok",function(t){t.preventDefault();if(e(a).is("[type=date]")){e(a).val(le.date.g(1)+"-"+(le.date.g(2)+1).pad(2)+"-"+le.date.g(3).pad(2)).change()}else if(h.format){e(a).val(moment(le.date).format(h.format)).change()}else if(h.timepicker){e(a).val(le.date.toLocaleString()).change()}else{e(a).val(le.date.toLocaleDateString()).change()}le[le.set].date=le.date;a.date=le.date;Z(a)});le.el.buttons.on("click",".button-delete",function(t){t.preventDefault();a.date=s;e(a).val("").change();Z(a)});le.el.buttons.children(".button-delete").toggleClass("disabled",a.value=="");le.el.buttons.on("click",".button-cancel",function(e){e.preventDefault();Z(a)});var d;e(t).on("resize",function(e){clearTimeout(d);i=U(a);le.css({top:i.top,left:i.left}).removeClass("animate");d=setTimeout(function(){le.addClass("animate")},100)})};var Z=function(a){e(a).removeClass("focused");le.removeClass("clockpicker md-datepicker-visible animate");le.el.buttons.off();e(t).off("resize")};var ee=function(){if(ie()){var t=le.set=="start"?"end":"start";var a=e(".md-select-wrap>span:matches("+le[t].date.g(1)+")");if(le.start.date&&le.start.date.g(1)==le.date.g(1)&&t=="start"||le.end.date&&le.end.date.g(1)==le.date.g(1)&&t=="end"){e(le.el.prev_next_btns[le.set=="start"|0]).toggleClass("disabled",le[t].date.g(2)==le.date.g(2));a.push(e(".md-select-wrap>span[data-month="+le[t].date.g(2)+"]")[0]);le.find(".md-select-wrap>span").removeClass("disabled");if(le.set=="end"){e(a[1]).prevAll().addClass("disabled");e(a[0]).nextAll().addClass("disabled")}else{e(a[0]).prevAll().addClass("disabled");e(a[1]).nextAll().addClass("disabled")}}}else{le.find(".md-select-wrap>span").removeClass("disabled")}le.el.months.text(le.date.toLocaleString(h.language,{month:"long"}));le.el.years.text(le.date.g(1));le.el.days.text(le.date.g(3));le.el.weekday.text(le.date.toLocaleString(h.language,{weekday:"short"}).replace(".",""));if(h.timepicker){le.removeClass("minute");le.currentView="hours";le.toggleClass("pm",le.date.g(4)>=12);le.el.hour.text(le.date.g(4).pad(2));le.el.minute.text(le.date.g(5).pad(2));var s=le.date.g(4)*(Math.PI/6),n=Math.sin(s)*L,i=-Math.cos(s)*L;J(n,i)}};var te=function(t){le.toggleClass("minute",!e(t.target).is(".md-hour"));le.currentView=!e(t.target).is(".md-hour")?"minutes":"hours";var a=(!e(t.target).is(".md-hour")?le.el.minute.text():le.el.hour.text())*(Math.PI/(le.currentView==="hours"?6:30)),s=Math.sin(a)*L,n=-Math.cos(a)*L;J(s,n)};var ae=function(t){var a=t=="year"?e(".md-select-wrap>span:matches("+le.date.g(1)+")"):e(".md-select-wrap>span[data-month="+le.date.g(2)+"]");if(!a.length){var s=le.date.g(1)-Number(le.el.select_year.children(":first-child").text());for(var n=1,i=Number(le.el.select_year.children(":first-child").text());n<=s;n++){le.el.select_year.prepend("<span>"+(i+n)+"</span>")}a=e(".md-select-wrap>span:matches("+le.date.g(1)+")")}var d=a.position().top;le.el["select_"+t].children("span").removeClass("md-currentdate");if(t=="year")e(".md-select-wrap>span:matches("+le.date.g(1)+")").addClass("md-currentdate");else e(".md-select-wrap>span[data-month="+le.date.g(2)+"]").addClass("md-currentdate");le.el["select_"+t].addClass("inview animate");le.el["select_"+t].stop().animate({scrollTop:d+le.el["select_"+t][0].scrollTop-(le.el["select_"+t][0].clientHeight-48)/2},parseInt(Math.abs(d.remap(0,2e3,500,3e3))),"easeInOutExpo");le.el["select_"+t].on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){le.el["select_"+t].removeClass("animate")});le.el["select_"+t].on("mousewheel",function(e){le.el["select_"+t].stop()})};var se=function(e){var t=le.range?e=="next"?le.set=="start"&&le.date.g(2)<le.end.date.g(2)||le.set=="start"&&le.date.g(1)!=le.end.date.g(1)||le.set=="end":le.set=="end"&&le.date.g(2)>le.start.date.g(2)||le.set=="end"&&le.date.g(1)!=le.start.date.g(1)||le.set=="start":true;var a=le.set=="start"?"end":"start";if(t){le.el.prev_next_btns.off("click");le.el.month_wrap.addClass("animate "+e);if(e=="next"){le.date.setMonth(le.date.g(2)+1)}else{le.date.setMonth(le.date.g(2)-1)}if(le.range&&le.set=="start"&&le.end.date<=le.date||le.range&&le.set=="end"&&le.start.date>=le.date){le.date=new Date(le[a].date);ne()}ee();le.el.month_wrap.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){le.el.current.html(le.el[e].html());le.el.month_wrap.removeClass("animate "+e);de("next");de("previous");le.el.month_wrap.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");le.el.prev_next_btns.on("click",re)})}};var ne=function(){var e=["next","previous"];for(var t=e.length-1;t>=0;t--){console.log(le.el[e[t]]);le.el[e[t]].find(".md-selecteddate").removeClass("md-selecteddate");le.el[e[t]].find("span:matches("+le.date.g(3)+")").addClass("md-selecteddate")}};function ie(){if(le.start&&le.end){return le.date!=s&&le[le.set=="start"?"end":"start"].date!=s}else return false}var de=function(e){var t=le.date.g(2),a=new Date(le.date),s,n="",i;if(e=="previous"){a.setMonth(t-1)}else if(e=="next"){a.setMonth(t+1)}s=v[startDay(a)];var d=daysInMonth(a);for(var r=h.startday;r<s+h.startday;r++){n+="<span></span>"}var l=p.g(2)==a.g(2)&&p.g(1)==a.g(1),o=le.set=="start"?"end":"start";if(le.range)var c=a.g(2)==le[o].date.g(2)&&a.g(1)==le[o].date.g(1);for(var r=1;r<=d;r++){i=[];if(le.date.g(3)==r)i.push("md-selecteddate");if(p.g(3)==r&&l)i.push("md-currentdate");if(le.range&&le.set=="start"&&r>le.end.date.g(3)&&c||le.range&&le.set=="end"&&r<le.start.date.g(3)&&c)i.push("disabled");n+="<span"+(i.length>=1?' class="'+i.join(" ")+'"':"")+" >"+r+"</span>"}le.el[e].find(".md-month-display").text(a.toLocaleString(h.language,{month:"long"}));le.el[e].find(".md-year-display").text(a.g(1));le.el[e].find(".md-week").html(n)};function re(){se(this.className.split(" ")[0].split("-")[1])}var le=e(G).appendTo("body");le.el={};if(h.timepicker){var oe=le.find(".md-clock");oe.append(W);le.hand=q;le.bg=K;le.fg=Q;le.bearing=B;le.g=X;le.canvas=oe;le.ticks={};le.ticks.minutes=le.canvas.find(".md-minutes>div");le.ticks.hours=le.canvas.find(".md-hours>div");le.el.hour=le.find(".md-hour");le.el.minute=le.find(".md-minute");le.el.ampm=le.find(".md-ampm-toggle");le.currentView="hours";oe.on(c,R)}le.el.years=le.find(".year");le.el.months=le.find(".month");le.el.days=le.find(".day");le.el.buttons=le.find(".md-buttons");le.el.weekday=le.find(".weekday");le.el.month_wrap=le.find(".md-months");le.el.current=le.find(".md-current-month");le.el.next=le.find(".md-next-month");le.el.prev_next_btns=le.find(".md-next").add(le.find(".md-previous"));le.el.select_month=le.find(".month-select");le.el.select_year=le.find(".year-select");le.el.previous=le.find(".md-previous-month");le.el.prev_next_btns.on("click",re);le.on("click",".month-select>span, .year-select>span",function(t){if(e(this).data("month")===s){le.date.setYear(e(this).text());le.el["select_year"].off()}else{le.date.setMonth(e(this).data("month"));le.el["select_month"].off()}if(le.range){if(le.set=="start"&&le.end.date<=le.date||le.set=="end"&&le.start.date>=le.date){var a=le.set=="start"?"end":"start";le.date=new Date(le[a].date)}}ee();de("current");e(this).parents(".md-select-wrap").addClass("animate").removeClass("inview").off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");de("previous");de("next")});le.el.months.on("click",function(e){ae("month")});le.el.years.on("click",function(e){ae("year")});le.on("click",".md-week span",function(t){e(".md-selecteddate").removeClass("md-selecteddate");le.el.month_wrap.find("span:matches("+e(this).text()+")").addClass("md-selecteddate");le.date.setDate(e(this).text());ee()});le.on("click",".md-toggle-state",function(e){le.toggleClass("clockpicker",!le.hasClass("clockpicker"))});le.on("click",".md-minute, .md-hour",function(e){te(e)});le.on("click",".md-pm, .md-am",function(t){le.toggleClass("pm",!e(t.target).is(".md-am"));var a=parseInt(le.el.hour.text());a=le.hasClass("pm")?a+12==24?12:a+12:a==0?0:a-12;le.el.hour.text(a.pad(2));le.date.setHours(a.pad(2))});var ce=this,me=[];return this.each(function(){this.initilized=true;e(this).on("focus",function(t){t.preventDefault();e(me).removeClass("focused");e(t.target).addClass("focused");ce.show(t.target)});me.push(this);if(e(this).is("[data-md-start]"))le.start=this;if(e(this).is("[data-md-end]"))le.end=this}).promise().done(function(){le.state="ready";if(me.length>2&&le.start){throw new Error("Only one start and one end Date is allowed")}le.container=me})};e.fn.md_datepicker.version="1.4.1-dev"})(jQuery,window,document);function daysInMonth(e){return new Date(e.g(1),e.g(2)+1,0).g(3)}function startDay(e){return new Date(e.g(1),e.g(2),1).g()}Number.prototype.remap=function(e,t,a,s){return a+(this-e)*(s-a)/(t-e)};Date.prototype.g=function(e){return e==1?this.getFullYear():e==2?this.getMonth():e==4?this.getHours():e==5?this.getMinutes():e==3?this.getDate():this.getDay()};Number.prototype.pad=function(e){var t=String(this);while(t.length<(e||2)){t="0"+t}return t};String.prototype.pad=function(e){var t=String(this);while(t.length<(e||2)){t="0"+t}return t};$.expr[":"].matches=$.expr.createPseudo(function(e){return function(t){return $(t).text().match("^"+e+"$")}});
