function n(e){return new Date(e.k().year,e.k().month+1,0).k().day}function i(e){return new Date(e.k().year,e.k().month,1).k().weekday}function t(){try{(new Date).toLocaleString("i")}catch(e){return"RangeError"===e.name}return!1}var a=0,e={en:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],weekday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g:{h:"delete",i:"cancel"}},de:{month:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekday:["So","Mo","Di","Mi","Do","Fr","Sa"],g:{h:"Löschen",i:"Abrrechen"}}},s=["moz","ms","webkit","o"];!function($,d,r,o){function l(){var t=r.createElement("div").style;if(t.flex!=o)return!0;for(var e=s.length-1;e>=0;e--)if(t[s[e]+"Flex"]!=o)return!0;return!1}$.fn.md_datepicker=function(ye){"use strict";function w(e){return r.createElementNS(he,e)}function L(e,t,a,n,s){return'<div class="lolliclock-tick" style="left:'+(e+Math.sin(t)*(m*s)-a).toFixed(2)+"px;top:"+(e-Math.cos(t)*(m*s)-a).toFixed(2)+'px">'+n+"</div>"}function ne(){return s.start&&s.end?s.p!=o&&s["start"==s.set?"end":"start"].p!=o:!1}function se(){fe(this.className.split(" ")[0].split("-")[1])}if(!l())return $(this).each(function(t,e){try{e.type="date"}catch(t){e.type="text"}});a++;var ee=!1;if(this.each(function(){this.j&&(ee=!0)}),!ee){var me={language:null,theme:"light",timepicker:!1,startday:1,autoclose:!1,mindate:null,maxdate:null,range:"past",color:null,_24h:!1,format:null,animated:!0,submit:"string",custom_class:""},ke=t(),V="ontouchstart"in d,ue="mousedown"+(V?" touchstart":""),J="mousemove.lolliclock"+(V?" touchmove.lolliclock":""),P="mouseup.lolliclock"+(V?" touchend.lolliclock":""),v="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",f=new Date,c=$.extend({},me,ye),H=[0,1,2,3,4,5,6],O=H.splice(-c.startday),H=O.concat(H);if(c.language=c.language?c.language:navigator.language||navigator.userLanguage||"en",f.setSeconds(0),c.format){var re=c.format.match(/\W/),oe=c.format.split(" ")[0].split(re).reverse();$.each(c.format.split(" ")[1].split(":"),function(t,e){oe.push(e)})}if(ke){for(var x,u=0,A=[];7>u;u++)x=new Date(2015,1,u),A[x.k().weekday]=x.toLocaleString(c.language,{weekday:"short"}).replace(".","");for(var x,u=0,T=[];12>u;u++)x=new Date(2015,u,1),T[u]=x.toLocaleString(c.language,{month:"long"})}else var A=e[c.language.split("-")[0]].weekday.slice(0),T=e[c.language.split("-")[0]].month.slice(0);O=A.splice(0,c.startday);var we=A.concat(O),S="",_="",Y="";$.each(we,function(t,e){_+="<span>"+e+"</span>"}),$.each(T,function(e,t){Y+='<span data-month="'+e+'">'+T[e]+"</span>"});var k=100,B=c.mindate.search(/^[-+]/)?moment(c.mindate):moment().add(c.mindate,"y"),q=c.maxdate.search(/^[-+]/)?moment(c.maxdate):moment().add(c.maxdate,"y");c.mindate&&c.maxdate?(k=moment.duration(q-B).l(),c.range="calculated"):c.mindate&&"past"==c.range?k=moment.duration(f-B).l():c.maxdate&&"future"==c.range&&(k=moment.duration(q-f).l());for(var x,u=0,Q="",I=c.range,N=f.k().year;k>=u;u++)Q+="<span>"+("future"==I?N+k-u:"past"==I?N-u:"calculated"==I?q.year()-u:N-(u-(k-k%2)/2))+"</span>";var be=$(this);be.each(function(){var e=this.cloneNode(!0);e.type="hidden",e.className="",e.m=this,e.id=this.id+"-timestamp",this.readOnly=!0,"timestamp"==c.submit?this.name="":e.name="",this.o=e,this.parentNode.appendChild(e),this.onchange=function(e){""!=this.value?(this.o.value=moment(this.value,c.format).unix(),this.p=new Date(moment(this.value,c.format).unix())):(this.o.value=0,this.o.p=o)},this.o.onchange=function(s){var t=Number(1e3*this.value),a=e.m.onchange;e.m.onchange=null,""==this.value?(e.m.value="",e.m.p=o):(e.m.value=moment(t).format(c.format),e.m.p=new Date(t)),$(e.m).change(),e.m.onchange=a}});for(var u=1;31>=u;u++)S+="<span>"+u+"</span>";if(c.timepicker){for(var u=r.styleSheets.length-1;u>=0;u--)if(r.styleSheets[u].href&&r.styleSheets[u].href.indexOf("md-datepicker")>0)for(var F=r.styleSheets[u].cssRules,u=F.length-1;u>=0;u--)if(".md-clock"==F[u].selectorText)var ve=parseInt(F[u].style.height);for(var C,p=ve/2,m=p-32,g=20,Z=2*p,ce=c._24h?25:13,u=1,G="";ce>u;u++)C=u/6*Math.PI,G+=c._24h&&13>u?L(p,C,g,u,.6):L(p,C,g,u,1);for(var C,u=0,z="";60>u;u+=5)C=u/30*Math.PI,z+=L(p,C,g,u.pad(2),1);var pe='<div class="md-datepicker-timeview"><div class="md-datepick-header"><div class="md-datepicker-headline"><span class="md-hour"></span>:<span class="md-minute"></span><div class="md-ampm-toggle"><span class="md-am">AM</span><span class="md-pm">PM</span></div></div><i class="md-toggle-state no-hover">&#xE878</i></div><div class="md-clock"><div class="md-hours">'+G+'</div><div class="md-minutes">'+z+"</div></div></div>",he="http://www.w3.org/2000/svg",ie=w("svg").q({class:"lolliclock-svg",width:Z,height:Z}),y=w("g").q({transform:"translate("+p+","+p+")"}),W=w("circle").q({class:"lolliclock-bearing",cx:0,cy:0,r:5}),K=w("line").q({x1:0,y1:0}),X=w("circle").q({class:"lolliclock-canvas-bg",r:20}),R=w("circle").q({class:"lolliclock-canvas-fg",r:3.5});y.appendChild(K),y.appendChild(X),y.appendChild(R),y.appendChild(W),ie.appendChild(y);var de=function(e){var o=M.offset(),d=/^touch/.test(e.type),n=o.left+p,i=o.top+p,t=(d?e.originalEvent.touches[0]:e).pageX-n,a=(d?e.originalEvent.touches[0]:e).pageY-i,l=Math.sqrt(t*t+a*a),u=!1;m-g>l||l>m+g||(e.preventDefault(),$(r.body).addClass("lolliclock-moving"),M.append(self.canvas),b(t,a),$(r).off(J).on(J,function(e){e.preventDefault();var s=/^touch/.test(e.type),r=(s?e.originalEvent.touches[0]:e).pageX-n,o=(s?e.originalEvent.touches[0]:e).pageY-i;(u||r!==t||o!==a)&&(u=!0,b(r,o))}),$(r).off(P).on(P,function(e){e.preventDefault();var o=/^touch/.test(e.type),d=(o?e.originalEvent.changedTouches[0]:e).pageX-n,l=(o?e.originalEvent.changedTouches[0]:e).pageY-i;d===t&&l===a&&b(d,l),"hours"===s.currentView?te(!0):c.autoclose,$(r.body).removeClass("lolliclock-moving"),$(r).off(J),$(r).off(P)}))}}var le='<div class="md-datepicker md-'+c.theme.split(" ").join(" md-")+("all"==c.animated||"inout"==c.animated||c.animated?" md-datepicker-animated":"")+(""!=c.custom_class?" "+c.custom_class:"")+'" id="md-datepicker-'+a.pad(3)+'"><div class="md-datepicker-views"><div class="md-datepicker-dateview"><div class="md-datepick-header"><div><span class="year"></span></div><div class="md-datepicker-headline"><span class="weekday"></span><span class="day"></span> <span class="month"></span></div>'+(c.timepicker?'<i class="md-toggle-state no-hover">&#xE192;</i>':"")+'</div><div class="md-datepick-month"><i class="md-previous md-touchtarget no-hover">&#xE408;</i><i class="md-next md-touchtarget no-hover">&#xE409;</i></div><div class="md-months"><div class="md-previous-month md-month"><div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div><div class="md-weekday">'+_+'</div><div class="md-week">'+S+'</div></div><div class="md-current-month md-month"><div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div><div class="md-weekday">'+_+'</div><div class="md-week">'+S+'</div></div><div class="md-next-month md-month"><div class="md-date-wrap"><span class="md-month-display"></span> <span class="md-year-display"></span></div><div class="md-weekday">'+_+'</div><div class="md-week">'+S+'</div></div></div><div class="month-select md-select-wrap">'+Y+'</div><div class="year-select md-select-wrap">'+Q+"</div></div>"+(c.timepicker?pe:"")+'</div><div class="md-buttons"><div class="md-button-flat button-delete">'+e[c.language.split("-")[0]].g.h+'</div><div class="md-button-flat button-cancel">'+e[c.language.split("-")[0]].g.i+'</div><div class="md-button-flat button-ok">OK</div></div></div>',b=function(o,d){var e,t=Math.atan2(-o,d)+Math.PI,a="hours"===s.currentView,n=Math.PI/(a?6:30);if(e=Math.round(t/n),t=e*n,a)0===e&&(e=12),s.s.style.visibility="hidden",s.u.t.text(s.hasClass("pm")?e+12==24?12:(e+12).pad(2):12==e?"00":e.pad(2)),s.p.setHours(s.u.t.text());else{var l=e%5===0;l?s.s.style.visibility="hidden":s.s.style.visibility="visible",60===e&&(e=0),s.u.v.text(e.pad(2)),s.p.setMinutes(s.u.v.text())}var c="hours"==s.currentView?s.A.hours:s.A.minutes;c.each(function(a,t){$(t).toggleClass("active",$(t).text()==e)}),s.B.insertBefore(s.C,s.D),s.B.insertBefore(s.F,s.s),s.F.setAttribute("class","lolliclock-canvas-bg");var i=Math.sin(t)*m,r=-Math.cos(t)*m;s.C.q({x2:Math.sin(t)*(m-g),y2:-Math.cos(t)*(m-g)}),s.F.q({cx:i,cy:r}),s.s.q({cx:i,cy:r})},U=function(n){var e=$(n).offset(),t=s.width(),a=s.height();return e.top=e.top+a+8>=d.innerHeight?d.innerHeight-a-8:e.top,e.left=e.left+t+8>=d.innerWidth?d.innerWidth-t-8:e.left,e};this.show=function(e){s.set=s.start==e?"start":"end";var n=""!=e.value?c.format?moment(e.value,c.format):moment(e.value):moment("start"==s.set?s.end.p:s.start.p),t=U(e);s.p=new Date(n),s.p=isNaN(s.p.getTime())?new Date:s.p,s.range=ne(),s.u.G.removeClass("disabled"),h("current"),h("previous"),h("next"),D(),c.animated?(s.on(v,function(){s.addClass("animate"),s.off(v)}),s.hasClass("clockpicker")?(s.removeClass("clockpicker"),s.on(v,".md-datepicker-views",function(e){e.preventDefault(),$(s).css({top:t.top,left:t.left}).off(v)})):$(s).css({top:t.top,left:t.left}).addClass("md-datepicker-visible")):$(s).css({top:t.top,left:t.left}).addClass("md-datepicker-visible"),s.u.buttons.off(),s.u.buttons.on("click",".button-ok",function(t){t.preventDefault(),$(e).is("[type=date]")?$(e).val(s.p.k().year+"-"+(s.p.k().month+1).pad(2)+"-"+s.p.k().day.pad(2)).change():c.format?$(e).val(moment(s.p).format(c.format)).change():c.timepicker?$(e).val(s.p.toLocaleString()).change():$(e).val(s.p.toLocaleDateString()).change(),s[s.set].p=s.p,e.p=s.p,j(e)}),s.u.buttons.on("click",".button-delete",function(t){t.preventDefault(),e.p=o,$(e).val("").change(),j(e)}),s.u.buttons.children(".button-delete").toggleClass("disabled",""==e.value),s.u.buttons.on("click",".button-cancel",function(t){t.preventDefault(),j(e)});var a;$(d).on("resize",function(n){clearTimeout(a),t=U(e),s.css({top:t.top,left:t.left}).removeClass("animate"),a=setTimeout(function(){s.addClass("animate")},100)})};var j=function(e){$(e).removeClass("focused"),s.removeClass("clockpicker md-datepicker-visible animate"),s.u.buttons.off(),$(d).off("resize")},D=function(){if(ne()){var e="start"==s.set?"end":"start",t=$(".md-select-wrap>span:matches("+s[e].p.k().year+")");(s.start.p&&s.start.p.k().year<=s.p.k().year&&"start"==e||s.end.p&&s.end.p.k().year>=s.p.k().year&&"end"==e)&&($(s.u.G["start"==s.set|0]).toggleClass("disabled",s.p.k().year==s[e].p.k().year&&s[e].p.k().month==s.p.k().month),s.p.k().year==s[e].p.k().year&&t.push($(".md-select-wrap>span[data-month="+s[e].p.k().month+"]")[0]),s.find(".md-select-wrap>span").removeClass("disabled"),"end"==s.set?($(t[1]).prevAll().addClass("disabled"),$(t[0]).nextAll().addClass("disabled")):($(t[0]).prevAll().addClass("disabled"),$(t[1]).nextAll().addClass("disabled")))}else s.find(".md-select-wrap>span").removeClass("disabled");if(s.u.H.text(s.p.I(c.language,{month:"long"})),s.u.l.text(s.p.k().year),s.u.J.text(s.p.k().day),s.u.weekday.text(s.p.I(c.language,{weekday:"short"}).replace(".","")),c.timepicker){s.removeClass("minute"),s.currentView="hours",s.toggleClass("pm",s.p.k().hours>=12),s.u.t.text(s.p.k().hours.pad(2)),s.u.v.text(s.p.k().minutes.pad(2));var a=s.p.k().hours*(Math.PI/6),n=Math.sin(a)*m,i=-Math.cos(a)*m;b(n,i)}},te=function(e){s.toggleClass("minute",!$(e.target).is(".md-hour")),s.currentView=$(e.target).is(".md-hour")?"hours":"minutes";var t=($(e.target).is(".md-hour")?s.u.t.text():s.u.v.text())*(Math.PI/("hours"===s.currentView?6:30)),a=Math.sin(t)*m,n=-Math.cos(t)*m;b(a,n)},ae=function(e){var t=$("year"==e?".md-select-wrap>span:matches("+s.p.k().year+")":".md-select-wrap>span[data-month="+s.p.k().month+"]");if(!t.length){for(var i=s.p.k().year-Number(s.u.select_year.children(":first-child").text()),a=1,r=Number(s.u.select_year.children(":first-child").text());i>=a;a++)s.u.select_year.prepend("<span>"+(r+a)+"</span>");t=$(".md-select-wrap>span:matches("+s.p.k().year+")")}var n=t.position().top;s.u["select_"+e].children("span").removeClass("md-currentdate"),"year"==e?$(".md-select-wrap>span:matches("+s.p.k().year+")").addClass("md-currentdate"):$(".md-select-wrap>span[data-month="+s.p.k().month+"]").addClass("md-currentdate"),s.u["select_"+e].addClass("inview animate"),s.u["select_"+e].stop().animate({scrollTop:n+s.u["select_"+e][0].scrollTop-(s.u["select_"+e][0].clientHeight-48)/2},parseInt(Math.abs(n.K(0,2e3,500,3e3))),"easeInOutExpo"),s.u["select_"+e].on(v,function(){s.u["select_"+e].removeClass("animate")}),s.u["select_"+e].on("mousewheel",function(t){s.u["select_"+e].stop()})},fe=function(e){var t=s.range?"next"==e?"start"==s.set&&s.p.k().month<s.end.p.k().month||"start"==s.set&&s.p.k().year!=s.end.p.k().year||"end"==s.set:"end"==s.set&&s.p.k().month>s.start.p.k().month||"end"==s.set&&s.p.k().year!=s.start.p.k().year||"start"==s.set:!0,a="start"==s.set?"end":"start";t&&(s.u.G.off("click"),s.u.L.addClass("animate "+e),"next"==e?s.p.setMonth(s.p.k().month+1):s.p.setMonth(s.p.k().month-1),(s.range&&"start"==s.set&&s.end.p<=s.p||s.range&&"end"==s.set&&s.start.p>=s.p)&&(s.p=new Date(s[a].p),ge()),D(),s.u.L.on(v,function(){s.u.current.html(s.u[e].html()),s.u.L.removeClass("animate "+e),h("next"),h("previous"),s.u.L.off(v),s.u.G.on("click",se)}))},ge=function(){for(var t=["next","previous"],e=t.length-1;e>=0;e--)s.u[t[e]].find(".md-selecteddate").removeClass("md-selecteddate"),s.u[t[e]].find("span:matches("+s.p.k().day+")").addClass("md-selecteddate")},h=function(r){var d,a,l=s.p.k().month,e=new Date(s.p),o="";"previous"==r?e.setMonth(l-1):"next"==r&&e.setMonth(l+1),d=H[i(e)];for(var p=n(e),t=c.startday;t<d+c.startday;t++)o+="<span></span>";var h=f.k().month==e.k().month&&f.k().year==e.k().year,u="start"==s.set?"end":"start";if(s.range)var m=e.k().month==s[u].p.k().month&&e.k().year==s[u].p.k().year;for(var t=1;p>=t;t++)a=[],s.p.k().day==t&&a.push("md-selecteddate"),f.k().day==t&&h&&a.push("md-currentdate"),(s.range&&"start"==s.set&&t>s.end.p.k().day&&m||s.range&&"end"==s.set&&t<s.start.p.k().day&&m)&&a.push("disabled"),o+="<span"+(a.length>=1?' class="'+a.join(" ")+'"':"")+" >"+t+"</span>";s.u[r].find(".md-month-display").text(e.I(c.language,{month:"long"})),s.u[r].find(".md-year-display").text(e.k().year),s.u[r].find(".md-week").html(o)},s=$(le).appendTo("body");if(s.u={},c.timepicker){var M=s.find(".md-clock");M.append(ie),$.extend(s,{C:K,F:X,s:R,D:W,B:y,canvas:M,A:{}}),s.A.minutes=s.canvas.find(".md-minutes>div"),s.A.hours=s.canvas.find(".md-hours>div"),s.u.t=s.find(".md-hour"),s.u.v=s.find(".md-minute"),s.u.M=s.find(".md-ampm-toggle"),s.currentView="hours",M.on(ue,de)}s.u.l=s.find(".year"),s.u.H=s.find(".month"),s.u.J=s.find(".day"),s.u.buttons=s.find(".md-buttons"),s.u.weekday=s.find(".weekday"),s.u.L=s.find(".md-months"),s.u.current=s.find(".md-current-month"),s.u.next=s.find(".md-next-month"),s.u.G=s.find(".md-next").add(s.find(".md-previous")),s.u.select_month=s.find(".month-select"),s.u.select_year=s.find(".year-select"),s.u.previous=s.find(".md-previous-month"),s.u.G.on("click",se),s.on("click",".month-select>span, .year-select>span",function(t){if($(this).data("month")===o?(s.p.setYear($(this).text()),s.u.select_year.off()):(s.p.setMonth($(this).data("month")),s.u.select_month.off()),s.range&&("start"==s.set&&s.end.p<=s.p||"end"==s.set&&s.start.p>=s.p)){var e="start"==s.set?"end":"start";s.p=new Date(s[e].p)}D(),h("current"),$(this).parents(".md-select-wrap").addClass("animate").removeClass("inview").off(v),h("previous"),h("next")}),s.u.H.on("click",function(e){ae("month")}),s.u.l.on("click",function(e){ae("year")}),s.on("click",".md-week span",function(e){$(".md-selecteddate").removeClass("md-selecteddate"),s.u.L.find("span:matches("+$(this).text()+")").addClass("md-selecteddate"),s.p.setDate($(this).text()),D()}),s.on("click",".md-toggle-state",function(e){s.toggleClass("clockpicker",!s.hasClass("clockpicker"))}),s.on("click",".md-minute, .md-hour",function(e){te(e)}),s.on("click",".md-pm, .md-am",function(t){s.toggleClass("pm",!$(t.target).is(".md-am"));var e=parseInt(s.u.t.text());e=s.hasClass("pm")?e+12==24?12:e+12:0==e?0:e-12,s.u.t.text(e.pad(2)),s.p.setHours(e.pad(2))});var xe=this,E=[];return this.each(function(){this.j=!0,$(this).on("focus",function(e){e.preventDefault(),$(E).removeClass("focused"),$(e.target).addClass("focused"),xe.show(e.target)}),E.push(this),$(this).is("[data-md-start]")&&(s.start=this),$(this).is("[data-md-end]")&&(s.end=this)}).promise().done(function(){if(s.state="ready",E.length>2&&s.start)throw new Error("Only one start and one end Date is allowed");s.N=E})}}}(jQuery,window,document),Number.prototype.K=function(e,a,t,s){return t+(this-e)*(s-t)/(a-e)},Date.prototype.k=function(){return{year:this.getFullYear(),month:this.getMonth(),hours:this.getHours(),minutes:this.getMinutes(),day:this.getDate(),weekday:this.getDay()}},Date.prototype.I=function(s,a){return t()?this.toLocaleString(s,a):e[s.split("-")[0]][Object.keys(a)[0]][this.k()[Object.keys(a)]]},Element.prototype.q=function(t){"use strict";for(var e in t)t.hasOwnProperty(e)&&(this instanceof SVGElement||(this[e]=t[e]),this[e]!=t[e]&&this.setAttribute(e,t[e]));return this},Number.prototype.pad=function(t){for(var e=String(this);e.length<(t||2);)e="0"+e;return e},String.prototype.pad=function(t){for(var e=String(this);e.length<(t||2);)e="0"+e;return e},$.expr[":"].matches=$.expr.createPseudo(function(e){return function(t){return $(t).text().match("^"+e+"$")}});
